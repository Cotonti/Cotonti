/**
 * @package Cotonti
 * @copyright (c) Cotonti Team
 * @license https://github.com/Cotonti/Cotonti/blob/master/License.txt
 */
(()=>{"use strict";class e extends EventTarget{mode="production";eventsUrl=null;constructor(e,t=""){super(),null!==t&&(this.mode=t),this.eventsUrl=e}init(){}onEventTriggered(e){"production"!==this.mode&&console.log("ServerEventsDriver: Server triggered event",e);const t=new CustomEvent("event",{detail:e,data:{bar:"baz"}});this.dispatchEvent(t)}}class t extends e{}class n extends e{#e=null;init(){null===this.#e&&("production"!==this.mode&&console.log("init ServerEventsSSEDriver. ",this.eventsUrl),this.#e=new EventSource(this.eventsUrl),"production"!==this.mode&&(this.#e.onopen=function(e){console.log("ServerEventsSSEDriver connection is open")}),this.#e.onmessage=e=>{const t=JSON.parse(e.data);void 0!==t.data&&"string"==typeof t.data&&""!==t.data&&(t.data=JSON.parse(t.data)),t.eventId=e.lastEventId,this.onEventTriggered(t)},"production"!==this.mode&&(this.#e.onerror=function(e){console.log("ServerEventsSSEDriver connection error")}))}}class s extends EventTarget{mode="production";driverType="";constructor(e,t=null){super(),this.driverType=e,null!==t&&(this.mode=t),this.init()}onEventTriggered(e){"production"!==this.mode&&console.log("ServerEventsClient: Server triggered event",e);const t=new CustomEvent("event",{detail:e});this.dispatchEvent(t)}}class o{#t="/";#n="production";constructor(e=null,t=null){null!==e&&(this.#t=e),null!==t&&(this.#n=t)}getByType(e){let s=null;const o=this.#t+"?n=server-events&a=sse",i=this.#t+"?n=server-events&a=ajax";return"serverSentEvents"===e?(s=new n(o),"production"!==this.#n&&console.log("using ServerEventsSSEDriver",o)):(s=new t(i),"production"!==this.#n&&console.log("using ServerEventsAjaxDriver",i)),s}}class i extends s{init(){"production"!==this.mode&&console.log("init ServerEventsClient");const e=new o(getBaseHref(),this.mode).getByType(this.driverType,this.mode);e.addEventListener("event",(e=>{this.onEventTriggered(e.detail)})),e.init()}}class r extends s{init(){"production"!==this.mode&&console.log("init ServerEventsSharedWorkerClient");try{const e=new SharedWorker("/js/sharedWorkerServerEvents.min.js").port;e.postMessage({config:{mode:this.mode,driver:this.driverType,baseUrl:getBaseHref()}}),e.onmessage=e=>{"production"!==this.mode&&console.log("ServerSentEventsSharedWorker event",e.data),this.onEventTriggered(e.data)}}catch(e){console.error(e)}}}class a{mode="production";#s=null;#o="sharedWorker";#i="serverSentEvents";#r=null;constructor(){this.#r=new Map}addObserver(e,t,n){this.#r.set(e,{name:e,event:t,onEvent:n}),null===this.#s&&this.#a()}#a(){"sharedWorker"===this.#o&&void 0!==typeof SharedWorker?("production"!==this.mode&&console.log("creating ServerEventsSharedWorkerClient"),this.#s=new r(this.#i,this.mode)):("production"!==this.mode&&console.log("creating ServerEventsClient"),this.#s=new i(this.#i,this.mode)),this.#s.addEventListener("event",(e=>{this.#l(e.detail)}))}#l(e){"production"!==this.mode&&console.log("Server triggered event",e),this.#r.forEach((t=>{t.event===e.event&&"function"==typeof t.onEvent&&t.onEvent(e)}))}}class l{static containerClass="toast-container position-fixed bottom-0 end-0 p-3";title="";message="";hint="";type="";delay=5e3;#d=null;constructor(e,t="",n="",s=""){void 0!==window.bootstrap?(this.title=t,this.message=e,this.hint=n,this.type=s):console.error('Bootstrap is not found. It is required for use "Toast" component')}show(){if(null===this.#d){let e=document.getElementById("toast-container");null===e&&(e=this.#c()),this.#d=e}const e=`<strong class="me-auto">${this.title}</strong>`,t=""!==this.hint?`<small>${this.hint}</small>`:"",n=`<div class="toast${""!==this.type?` text-bg-${this.type}`:""}" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="${this.delay}"><div class="toast-header">${e}${t}<button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button></div><div class="toast-body">${this.message}</div></div>`,s=document.createElement("div");s.innerHTML=n;const o=s.firstElementChild;this.#d.appendChild(o),new window.bootstrap.Toast(o).show(),this.#d.lastElementChild.addEventListener("hidden.bs.toast",(()=>{o.remove(),""===this.#d.innerHTML&&(this.#d.remove(),this.#d=null)}))}#c(){const e=document.createElement("div");return e.id="toast-container",e.className=l.containerClass,document.body.append(e),e}}class d{title="";content="";buttons=null;centered=!1;dialogClass="modal-dialog";#h=null;constructor(e,t="",n=null){void 0!==window.bootstrap?(this.title=t,this.content=e,this.buttons=n):console.error('Bootstrap is not found. It is required for use "Modal" component')}show(){let e=this.dialogClass;this.centered&&(e+=" modal-dialog-centered");const t=`<div class="modal fade" id="CotontiDynamicModal" tabindex="-1" aria-labelledby="CotontiDynamicModalLabel" aria-hidden="true"><div class="${e}"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="CotontiDynamicModalLabel">${this.title}</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body">${this.content}</div><div class="modal-footer"></div></div></div></div>`,n=document.createElement("div");n.innerHTML=t,this.#h=n.firstElementChild,this.#v(),document.body.appendChild(this.#h),new bootstrap.Modal(this.#h).show(),this.#h.addEventListener("hidden.bs.modal",(()=>{this.#h.remove()}))}#v(){const e=this.#u();if(""===e||e===[])return;const t=this.#h.querySelector(".modal-footer");"string"!=typeof e?Array.isArray(e)&&e.forEach((e=>{"string"!=typeof e?t.appendChild(e):t.innerHTML+=e})):t.innerHTML=e}#u(){const e=[];let t=this.buttons;return t===[]?e:null===t?'<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>':"string"==typeof t?t:(Array.isArray(t)&&t.forEach((t=>{if("string"==typeof t)return void e.push(t);const n=document.createElement("button");void 0!==t.label&&(n.innerHTML=t.label),n.setAttribute("type",void 0!==t.btnType?t.btnType:"button"),n.classList.add("btn"),void 0!==t.type&&n.classList.add("btn-"+t.type),void 0!==t.closeOnClick&&!0===t.closeOnClick&&n.setAttribute("data-bs-dismiss","modal"),void 0!==t.onClick&&"function"==typeof t.onClick&&n.addEventListener("click",(e=>t.onClick(e))),e.push(n)})),e)}}window.cot=new class{#p=null;getServerEvents(){return null===this.#p&&(this.#p=new a),this.#p}confirm(e,t,n,s="Ok",o="Cancel"){this.modal(e,t,[{label:s,onClick:e=>n(e),type:"primary",closeOnClick:!0},{label:o,closeOnClick:!0,type:"secondary"}])}getModal(e,t="",n=null){return new d(e,t,n)}modal(e,t="",n=null){const s=this.getModal(e,t,n);return s.show(),s}getToast(e,t="",n="",s=""){return new l(e,t,n,s)}toast(e,t="",n="",s="",o=5e3){const i=this.getToast(e,t,n,s);return null!==o&&(i.delay=o),i.show(),i}async loadData(e){if(!e)return{};void 0===this.loadedData&&(this.loadedData={});let t=[];("string"==typeof e||e instanceof String)&&(e=[e]);for(let n of e)n in this.loadedData||t.push(n);if(t.length>0){let e=new URLSearchParams({n:"main",a:"get"});t.forEach(((t,n,s)=>{e.append("data["+n+"]",t)})),e.append("_ajax",1);try{let t=await fetch("index.php?"+e.toString());if(t.ok){const e=await t.json();if(e.success)for(const t in e.data)this.loadedData[t]=e.data[t]}}catch(e){}}let n={};for(let t of e)t in this.loadedData&&(n[t]=this.loadedData[t]);return n}loadCaptcha(){this.loadData(["captcha","x"]).then((e=>{let t=document.querySelectorAll(".captcha-place-holder");for(let n of t){n.innerHTML=e.captcha,this.executeScriptElements(n),n.classList.remove("captcha-place-holder","loading"),n.classList.add("captcha");const t=n.closest("form");if(null!==t){let n=t.querySelector('input[type="hidden"][name="x"]');null!==n&&n.setAttribute("value",e.x)}}}))}executeScriptElements(e){const t=e.querySelectorAll("script");Array.from(t).forEach((e=>{const t=document.createElement("script");Array.from(e.attributes).forEach((e=>{t.setAttribute(e.name,e.value)})),t.text=e.text,e.parentNode.replaceChild(t,e)}))}}})();

function encodeURIfix(str) {
	// to prevent twice encoding
	// and fix '[',']' signs to follow RFC3986 (section-3.2.2)
	return encodeURI(decodeURI(str)).replace(/%5B/g, '[').replace(/%5D/g, ']');
}

function getBaseHref() {
	var href = document.getElementsByTagName('base')[0].href;
	if (href == null) {
		return '/';
	} else {
		return href;
	}
}

function popup(code, w, h){
    window.open(getBaseHref() + 'index.php?o=' + code, '', 'toolbar=0,location=0,directories=0,menuBar=0,resizable=0,scrollbars=yes,width=' + w + ',height=' + h + ',left=32,top=16');
}

/**
 * @todo move to pfs module
 */
function pfs(id, c1, c2, parser){
    window.open(
		getBaseHref() + 'index.php?e=pfs&userid=' + id + '&c1=' + c1 + '&c2=' + c2 + '&parser=' + parser,
		'PFS',
		'status=1, toolbar=0,location=0,directories=0,menuBar=0,resizable=1,scrollbars=yes,width=754,height=512,left=32,top=16'
	);
}

function redirect(url){
    location.href = url.options[url.selectedIndex].value;
}

function toggleblock(id){
    var bl = document.getElementById(id);
    if (bl.style.display == 'none') {
        bl.style.display = '';
    }
    else {
        bl.style.display = 'none';
    }
	return false;
}

function toggleAll(action) {
	var blks = document.querySelectorAll('[id^="blk_"]');
	for (i = 0; i < blks.length; i++) {
		if (action == 'hide') {
			blks[i].style.display = 'none';
		} else if (action == 'show') {
			blks[i].style.display = 'table-row-group';
		}
	}
	return false;
}

// Inserts text into textarea at cursor position
function insertText(docObj, fieldName, value) {
	var field = null;
	if (!docObj) {
		docObj = document;
	}
	// Find the field in the docObj
	findField:
	for (var i = 0; i < docObj.forms.length; i++) {
		for (var j = 0; j < docObj.forms[i].elements.length; j++) {
			if (docObj.forms[i].elements[j].name == fieldName) {
				field = docObj.forms[i].elements[j];
				break findField;
			}
		}
	}
	if (!field) {
		return false;
	}

	// Insert the text
	if (docObj.selection) {
		// MSIE and Opera
		field.focus();
		var sel = docObj.selection.createRange();
		sel.text = value;
	} else if (field.selectionStart || field.selectionStart == 0) {
		// Mozilla
		var startPos = field.selectionStart;
		var endPos = field.selectionEnd;
		field.value = field.value.substring(0, startPos) + value + field.value.substring(endPos, field.value.length);
	} else {
		field.value += value;
	}
	return true;
}

// Array of ajax error handlers
// Example of use:
// ajaxErrorHandlers.push({func: myErrorHandler});
// ajaxSuccessHandlers.push({func: mySuccessHandler});
var ajaxErrorHandlers = new Array();
var ajaxSuccessHandlers = new Array();
// AJAX enablement defaults to false
var ajaxEnabled = false;
// Required to calculate paths
if (typeof jQuery != 'undefined') {
	var ajaxCurrentBase = location.href.replace($('base').eq(0).attr('href'), '').replace(/\?.*$/, '').replace(/#.*$/, '');
}
// This flag indicates that AJAX+history has been used on this page
// It means that "#" or home link should be loaded via ajax too
var ajaxUsed = false;
// Global flag to let everybody know that AJAX has failed
var ajaxError = false;

/**
 * AJAX helper function
 * @param {hash} settings A hashtable with settings
 * @return FALSE on successful AJAX call, TRUE on error to continue in
 * synchronous mode
 * @type bool
 */
function ajaxSend(settings) {
	var method = settings.method ? settings.method.toUpperCase() : 'GET';
	var data = settings.data || '';
	var url = settings.url || $('#' + settings.formId).attr('action');
	if (method === 'POST') {
		data += '&' + $('#' + settings.formId).serialize();
	} else if (settings.formId) {
		var sep = url.indexOf('?') > 0 ? '&' : '?';
		url += sep + $('#' + settings.formId).serialize();
	}
	$.ajax({
		type: method,
		url: encodeURIfix(url),
		data: data,
		beforeSend: function() {
			if (!settings.nonshowloading) {
				$('#' + settings.divId)
					.append('<span style="position:absolute; left:' + ($('#' + settings.divId).width()/2 - 110) + 'px;top:' + ($('#' + settings.divId).height()/2 - 9) + 'px;" class="loading" id="loading"><img src="./images/spinner.gif" alt="loading"/></span>').css('position', 'relative');
			}
		},
		success: function(msg) {
			if (!settings.nonshowloading) {
				$('#loading').remove();
			}
			if (!settings.nonshowfadein) {
				$('#' + settings.divId).hide().html(msg).fadeIn(500);
			} else {
				$('#' + settings.divId).html(msg);
			}
			for (var i = 0; i < ajaxSuccessHandlers.length; i++) {
				if(ajaxSuccessHandlers[i].func)
					ajaxSuccessHandlers[i].func(msg);
				else
					ajaxSuccessHandlers[i](msg);
			}
		},
		error: function(msg) {
			if (!settings.nonshowloading) {
				$('#loading').remove();
			}
			if (!settings.nonshowfadein) {
				$('#' + settings.divId).hide().html(msg).fadeIn(500);
			} else {
				$('#' + settings.divId).html(msg);
			}
			if (ajaxErrorHandlers.length > 0) {
				for (var i = 0; i < ajaxErrorHandlers.length; i++) {
					if (ajaxErrorHandlers[i].func) {
						ajaxErrorHandlers[i].func(msg);
					} else {
						ajaxErrorHandlers[i](msg);
					}
				}
			} else {
				alert('AJAX error: ' + msg);
				ajaxError = true;
			}
		}
	});
	return false;
}

/**
 * AJAX subpage loader with history support
 * @param {string} hash A hash-address string
 * @return FALSE on successful AJAX call, TRUE on error to continue in
 * synchronous mode
 * @type bool
 */
function ajaxPageLoad(hash) {
    if (hash !== '') {
		hash.replace(/^#/, '');
	}
	var m = hash.match(/^get(-.*?)?;(.*)$/);
	if (m) {
		// ajax bookmark
        var url = m[2].indexOf(';') > 0 ? m[2].replace(';', '?') : ajaxCurrentBase + '?' + decodeURIComponent(m[2]);
		ajaxUsed = true;
		return ajaxSend({
			method: 'GET',
			url: url,
			divId: m[1] ? m[1].substr(1) : 'ajaxBlock'
		});
	} else if (hash === '' && ajaxUsed) {
		// ajax home
		return ajaxSend ({
			url: location.href.replace(/#.*$/, ''),
			divId: 'ajaxBlock'
		});
	}
	return true;
}

/**
 * AJAX subform loader without history tracking
 * @param {string} hash A hash-address string
 * @param {string} formId Target form id attribute
 * @return FALSE on successful AJAX call, TRUE on error to continue in
 * synchronous mode
 * @type bool
 */
function ajaxFormLoad(hash, formId) {
	var m = hash.match(/^(get|post)(-.*?)?;(.*)$/);
	if (m) {
		// ajax bookmark
		var url = m[3].indexOf(';') > 0 ? m[3].replace(';', '?') : ajaxCurrentBase + '?' + m[3];
		ajaxUsed = true;
		return ajaxSend({
			method: m[1].toUpperCase(),
			url: url,
			divId: m[2] ? m[2].substr(1) : 'ajaxBlock',
			formId: formId
		});
	}
	return true;
}

/**
 * Constructs ajaxable hash string
 * @param {string} href Link href or form action attribute
 * @param {string} rel An attribute value possibly containing a hash address
 * @param {string} formData Is passed for forms only, is 'post' for POST forms
 * or serialized form data for GET forms
 * @return A valid hash-address string
 * @type string
 */
function ajaxMakeHash(href, rel, formData) {
	var hash = (formData == 'post') ? 'post' : 'get';
	var hrefBase, params;
	var sep = '?';
	var m = rel ? rel.match(/(get|post)(-[^ ;]+)?(;\S*)?/) : false;
	if (m) {
		hash = m[1];
		if (m[2]) {
			hash += m[2];
		}
		if (m[3]) {
			href = m[3].substr(1);
			sep  = ';';
		}
	}
	hash += ';'
	if (href.indexOf(sep) > 0) {
		hrefBase = href.substr(0, href.indexOf(sep));
		params = href.substr(href.indexOf(sep) + 1);
		if (formData && formData != 'post') {
			params += '&' + formData;
		}
	} else {
		hrefBase = href;
		params = '';
		if (formData && formData != 'post') {
			params += sep + formData;
		}
	}
	hash += hrefBase == ajaxCurrentBase ? params : hrefBase + ';' + params;
	return hash;
}

/**
 * Standard event bindings
 */
function bindHandlers() {
	if (location.hash == '#comments' || location.hash.match(/#c\d+/)) {
		$('.comments').css('display', '');
	}
	$('.comments_link').click(function() {
		if($('.comments').css('display') == 'none') {
			$('.comments').css('display', '');
		} else {
			$('.comments').css('display', 'none');
		}
	});

	if(location.href.match(/#comments/)) {
		$('.comments').css('display', '');
	}

	if (ajaxEnabled) {
		// AJAX auto-handling
		$('body').on('submit', 'form.ajax', function() {
			if ($(this).attr('method').toUpperCase() == 'POST') {
				ajaxFormLoad(ajaxMakeHash($(this).attr('action').replace(/#.*$/, ''), $(this).attr('class'), 'post'), $(this).attr('id'));
			} else {
				window.location.hash = ajaxMakeHash($(this).attr('action').replace(/#.*$/, ''), $(this).attr('class'), $(this).serialize());
			}
			return ajaxError;
		});
		$('body').on('click', 'a.ajax', function() {
			window.location.hash = ajaxMakeHash($(this).attr('href').replace(/#.*$/, ''), $(this).attr('rel'));
			return ajaxError;
		});

		// AJAX action confirmations
		$('body').on('click', 'a.confirmLink', function() {
			if ($(this).attr('href').match(/message.+920/i)) {
				if ($('#confirmBox')) {
					$('#confirmBox').remove();
				}
				$('body').prepend('<div id="confirmBox" class="jqmWindow"></div>');
				$('#confirmBox').jqm({ajax:$(this).attr('href'),modal:true,onLoad:function(){
					$('#confirmBox').css('margin-left', '-'+($('#confirmBox').width()/2)+'px');
					$('#confirmBox').css('margin-top', '-'+($('#confirmBox').height()/2)+'px');
				}});
				$('#confirmBox').jqmShow();
				return false;
			} else {
				return true;
			}
		});

		// Listen to hash change events
		$(window).on('hashchange', function() {
			ajaxPageLoad(window.location.hash.replace(/^#/, ''));
		});

		$('body').on('click', 'a#confirmNo', function() {
			if ($("#confirmBox").is(".jqmWindow"))
			{
				$('#confirmBox').jqmHide();
				$('#confirmBox').remove();
				return false;
			}
			else
			{
				return true;
			}
		});
	}
}

if (typeof jQuery != 'undefined') {
    $(document).ready(function() {
        // If page was loaded with hash
        if (ajaxEnabled) {
            if(window.location.hash != '') {
                ajaxPageLoad(window.location.hash.replace(/^#/, ''));
            }
        }

        bindHandlers();
    });
}

window.name = 'main';//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9oZWFkZXIuanMiLCJ3ZWJwYWNrOi8vY290b250aS9zcmMvc2VydmVyRXZlbnRzL2RyaXZlci9CYXNlU2VydmVyRXZlbnRzRHJpdmVyLmpzIiwid2VicGFjazovL2NvdG9udGkvc3JjL3NlcnZlckV2ZW50cy9kcml2ZXIvU2VydmVyRXZlbnRzQWpheERyaXZlci5qcyIsIndlYnBhY2s6Ly9jb3RvbnRpL3NyYy9zZXJ2ZXJFdmVudHMvZHJpdmVyL1NlcnZlckV2ZW50c1NTRURyaXZlci5qcyIsIndlYnBhY2s6Ly9jb3RvbnRpL3NyYy9zZXJ2ZXJFdmVudHMvY2xpZW50L0Jhc2VTZXJ2ZXJFdmVudHNDbGllbnQuanMiLCJ3ZWJwYWNrOi8vY290b250aS9zcmMvc2VydmVyRXZlbnRzL2RyaXZlci9TZXJ2ZXJFdmVudHNEcml2ZXJGYWN0b3J5LmpzIiwid2VicGFjazovL2NvdG9udGkvc3JjL3NlcnZlckV2ZW50cy9jbGllbnQvU2VydmVyRXZlbnRzQ2xpZW50LmpzIiwid2VicGFjazovL2NvdG9udGkvc3JjL3NlcnZlckV2ZW50cy9jbGllbnQvU2VydmVyRXZlbnRzU2hhcmVkV29ya2VyQ2xpZW50LmpzIiwid2VicGFjazovL2NvdG9udGkvc3JjL3NlcnZlckV2ZW50cy9TZXJ2ZXJFdmVudHMuanMiLCJ3ZWJwYWNrOi8vY290b250aS9zcmMvVG9hc3QuanMiLCJ3ZWJwYWNrOi8vY290b250aS9zcmMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vY290b250aS9zcmMvQ290b250aUFwcGxpY2F0aW9uLmpzIiwiYmFzZS5qcyJdLCJuYW1lcyI6WyJCYXNlU2VydmVyRXZlbnRzRHJpdmVyIiwiRXZlbnRUYXJnZXQiLCJtb2RlIiwiZXZlbnRzVXJsIiwiY29uc3RydWN0b3IiLCJzdXBlciIsInRoaXMiLCJpbml0Iiwib25FdmVudFRyaWdnZXJlZCIsImV2ZW50RGF0YSIsImNvbnNvbGUiLCJsb2ciLCJldmVudCIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwiZGF0YSIsImJhciIsImRpc3BhdGNoRXZlbnQiLCJTZXJ2ZXJFdmVudHNBamF4RHJpdmVyIiwiU2VydmVyRXZlbnRzU1NFRHJpdmVyIiwiRXZlbnRTb3VyY2UiLCJvbm9wZW4iLCJvbm1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJ1bmRlZmluZWQiLCJldmVudElkIiwibGFzdEV2ZW50SWQiLCJvbmVycm9yIiwiQmFzZVNlcnZlckV2ZW50c0NsaWVudCIsImRyaXZlclR5cGUiLCJTZXJ2ZXJFdmVudHNEcml2ZXJGYWN0b3J5IiwiYmFzZVVybCIsImdldEJ5VHlwZSIsImRyaXZlciIsInNlcnZlclNlbnRFdmVudHNVcmwiLCJhamF4RXZlbnRzVXJsIiwiU2VydmVyRXZlbnRzQ2xpZW50IiwiZ2V0QmFzZUhyZWYiLCJhZGRFdmVudExpc3RlbmVyIiwiU2VydmVyRXZlbnRzU2hhcmVkV29ya2VyQ2xpZW50IiwicG9ydCIsIlNoYXJlZFdvcmtlciIsInBvc3RNZXNzYWdlIiwiY29uZmlnIiwiZSIsImVycm9yIiwiU2VydmVyRXZlbnRzIiwiTWFwIiwiYWRkT2JzZXJ2ZXIiLCJuYW1lIiwiY2FsbGJhY2siLCJzZXQiLCJvbkV2ZW50IiwiZm9yRWFjaCIsIm9ic2VydmVyIiwiVG9hc3QiLCJzdGF0aWMiLCJ0aXRsZSIsIm1lc3NhZ2UiLCJoaW50IiwidHlwZSIsImRlbGF5Iiwid2luZG93IiwiYm9vdHN0cmFwIiwic2hvdyIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0b2FzdFRpdGxlIiwidG9hc3RIaW50IiwidG9hc3RIVE1MIiwidG9hc3RXcmFwcGVyIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInRvYXN0RWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiYXBwZW5kQ2hpbGQiLCJsYXN0RWxlbWVudENoaWxkIiwicmVtb3ZlIiwicmVzdWx0IiwiaWQiLCJjbGFzc05hbWUiLCJjb250YWluZXJDbGFzcyIsImJvZHkiLCJhcHBlbmQiLCJNb2RhbCIsImNvbnRlbnQiLCJidXR0b25zIiwiY2VudGVyZWQiLCJkaWFsb2dDbGFzcyIsIm1vZGFsSFRNTCIsIm1vZGFsV3JhcHBlciIsInF1ZXJ5U2VsZWN0b3IiLCJBcnJheSIsImlzQXJyYXkiLCJidXR0b24iLCJidXR0b25EYXRhIiwicHVzaCIsImxhYmVsIiwic2V0QXR0cmlidXRlIiwiYnRuVHlwZSIsImNsYXNzTGlzdCIsImFkZCIsImNsb3NlT25DbGljayIsIm9uQ2xpY2siLCJjb3QiLCJnZXRTZXJ2ZXJFdmVudHMiLCJjb25maXJtIiwib2tMYWJlbCIsImNhbmNlbExhYmVsIiwibW9kYWwiLCJnZXRNb2RhbCIsImdldFRvYXN0IiwidG9hc3QiLCJsb2FkRGF0YSIsIndoYXQiLCJsb2FkZWREYXRhIiwiZGF0YVRvTG9hZCIsIlN0cmluZyIsIml0ZW0iLCJsZW5ndGgiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJuIiwiYSIsImluZGV4IiwiYXJyYXkiLCJyZXNwb25zZSIsImZldGNoIiwidG9TdHJpbmciLCJvayIsInJlc3BvbnNlRGF0YSIsImpzb24iLCJzdWNjZXNzIiwia2V5IiwibG9hZENhcHRjaGEiLCJ0aGVuIiwiY2FwdGNoYUVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsImVsZW1lbnQiLCJjYXB0Y2hhIiwiZXhlY3V0ZVNjcmlwdEVsZW1lbnRzIiwiZm9ybSIsImNsb3Nlc3QiLCJpbnB1dFgiLCJ4IiwiY29udGFpbmVyRWxlbWVudCIsInNjcmlwdEVsZW1lbnRzIiwiZnJvbSIsInNjcmlwdEVsZW1lbnQiLCJjbG9uZWRFbGVtZW50IiwiYXR0cmlidXRlcyIsImF0dHJpYnV0ZSIsInZhbHVlIiwidGV4dCIsInBhcmVudE5vZGUiLCJyZXBsYWNlQ2hpbGQiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7bUJDSU8sTUFBTUEsVUFBK0JDLFlBQ3hDQyxLQUFPLGFBS1BDLFVBQVksS0FFWixXQUFBQyxDQUFZRCxFQUFXRCxFQUFPLElBQzFCRyxRQUVhLE9BQVRILElBQ0FJLEtBQUtKLEtBQU9BLEdBRWhCSSxLQUFLSCxVQUFZQSxDQUNyQixDQUVBLElBQUFJLEdBQVMsQ0FFVCxnQkFBQUMsQ0FBaUJDLEdBQ0ssZUFBZEgsS0FBS0osTUFDTFEsUUFBUUMsSUFBSSw2Q0FBOENGLEdBRzlELE1BQU1HLEVBQVEsSUFBSUMsWUFBWSxRQUFTLENBQ25DQyxPQUFRTCxFQUNSTSxLQUFNLENBQUNDLElBQUssU0FFaEJWLEtBQUtXLGNBQWNMLEVBQ3ZCLEVDbkNHLE1BQU1NLFVBQStCbEIsR0NNckMsTUFBTW1CLFVBQThCbkIsRUFJdkMsR0FBZSxLQUVmLElBQUFPLEdBQzhCLE9BQXRCRCxNQUFLLElBSVMsZUFBZEEsS0FBS0osTUFDTFEsUUFBUUMsSUFBSSwrQkFBZ0NMLEtBQUtILFdBR3JERyxNQUFLLEVBQWUsSUFBSWMsWUFBWWQsS0FBS0gsV0FFdkIsZUFBZEcsS0FBS0osT0FDTEksTUFBSyxFQUFhZSxPQUFTLFNBQVVULEdBQ2pDRixRQUFRQyxJQUFJLDJDQUNoQixHQUdKTCxNQUFLLEVBQWFnQixVQUFhVixJQUMzQixNQUFNSCxFQUFZYyxLQUFLQyxNQUFNWixFQUFNRyxXQUNaVSxJQUFuQmhCLEVBQVVNLE1BQWlELGlCQUFuQk4sRUFBVU0sTUFBeUMsS0FBbkJOLEVBQVVNLE9BQ2xGTixFQUFVTSxLQUFPUSxLQUFLQyxNQUFNZixFQUFVTSxPQUUxQ04sRUFBVWlCLFFBQVVkLEVBQU1lLFlBQzFCckIsS0FBS0UsaUJBQWlCQyxFQUFVLEVBR2xCLGVBQWRILEtBQUtKLE9BQ0xJLE1BQUssRUFBYXNCLFFBQVUsU0FBVWhCLEdBQ2xDRixRQUFRQyxJQUFJLHlDQUNoQixHQUVSLEVDMUNHLE1BQU1rQixVQUErQjVCLFlBSXhDQyxLQUFPLGFBS1A0QixXQUFhLEdBTWIsV0FBQTFCLENBQVkwQixFQUFZNUIsRUFBTyxNQUMzQkcsUUFFQUMsS0FBS3dCLFdBQWFBLEVBRUwsT0FBVDVCLElBQ0FJLEtBQUtKLEtBQU9BLEdBR2hCSSxLQUFLQyxNQUNULENBRUEsZ0JBQUFDLENBQWlCQyxHQUNLLGVBQWRILEtBQUtKLE1BQ0xRLFFBQVFDLElBQUksNkNBQThDRixHQUc5RCxNQUFNRyxFQUFRLElBQUlDLFlBQVksUUFBUyxDQUFDQyxPQUFRTCxJQUNoREgsS0FBS1csY0FBY0wsRUFDdkIsRUM3QkcsTUFBTW1CLEVBQ1QsR0FBVyxJQUVYLEdBQVEsYUFFUixXQUFBM0IsQ0FBWTRCLEVBQVUsS0FBTTlCLEVBQU8sTUFDZixPQUFaOEIsSUFDQTFCLE1BQUssRUFBVzBCLEdBRVAsT0FBVDlCLElBQ0FJLE1BQUssRUFBUUosRUFFckIsQ0FNQSxTQUFBK0IsQ0FBVUgsR0FDTixJQUFJSSxFQUFTLEtBRWIsTUFBTUMsRUFBc0I3QixNQUFLLEVBQVcseUJBQ3RDOEIsRUFBZ0I5QixNQUFLLEVBQVcsMEJBaUJ0QyxNQWRTLHFCQUREd0IsR0FFQUksRUFBUyxJQUFJZixFQUFzQmdCLEdBQ2hCLGVBQWY3QixNQUFLLEdBQ0xJLFFBQVFDLElBQUksOEJBQStCd0IsS0FLL0NELEVBQVMsSUFBSWhCLEVBQXVCa0IsR0FDakIsZUFBZjlCLE1BQUssR0FDTEksUUFBUUMsSUFBSSwrQkFBZ0N5QixJQUlqREYsQ0FDWCxFQ3hDRyxNQUFNRyxVQUEyQlIsRUFDcEMsSUFBQXRCLEdBQ3NCLGVBQWRELEtBQUtKLE1BQ0xRLFFBQVFDLElBQUksMkJBR2hCLE1BRU11QixFQUZVLElBQUlILEVBQTBCTyxjQUFlaEMsS0FBS0osTUFFM0MrQixVQUFVM0IsS0FBS3dCLFdBQVl4QixLQUFLSixNQUN2RGdDLEVBQU9LLGlCQUFpQixTQUFVM0IsSUFDOUJOLEtBQUtFLGlCQUFpQkksRUFBTUUsT0FBTyxJQUV2Q29CLEVBQU8zQixNQUNYLEVDYkcsTUFBTWlDLFVBQXVDWCxFQUNoRCxJQUFBdEIsR0FDc0IsZUFBZEQsS0FBS0osTUFDTFEsUUFBUUMsSUFBSSx1Q0FHaEIsSUFDSSxNQUNNOEIsRUFEUyxJQUFJQyxhQUFhLHVDQUNaRCxLQUVwQkEsRUFBS0UsWUFBWSxDQUFDQyxPQUFRLENBQUMxQyxLQUFNSSxLQUFLSixLQUFNZ0MsT0FBUTVCLEtBQUt3QixXQUFZRSxRQUFTTSxpQkFFOUVHLEVBQUtuQixVQUFhVixJQUNJLGVBQWROLEtBQUtKLE1BQ0xRLFFBQVFDLElBQUkscUNBQXNDQyxFQUFNRyxNQUU1RFQsS0FBS0UsaUJBQWlCSSxFQUFNRyxLQUFLLENBRXpDLENBQUUsTUFBTzhCLEdBQ0xuQyxRQUFRb0MsTUFBTUQsRUFDbEIsQ0FDSixFQ2xCRyxNQUFNRSxFQUNUN0MsS0FBTyxhQUtQLEdBQVUsS0FLVixHQUFjLGVBS2QsR0FBYyxtQkFFZCxHQUFxQixLQUVyQixXQUFBRSxHQUNJRSxNQUFLLEVBQXFCLElBQUkwQyxHQUNsQyxDQU9BLFdBQUFDLENBQVlDLEVBQU10QyxFQUFPdUMsR0FDckI3QyxNQUFLLEVBQW1COEMsSUFBSUYsRUFBTSxDQUM5QkEsS0FBTUEsRUFDTnRDLE1BQU9BLEVBQ1B5QyxRQUFTRixJQUdRLE9BQWpCN0MsTUFBSyxHQUNMQSxNQUFLLEdBRWIsQ0FFQSxLQUM2QixpQkFBckJBLE1BQUssUUFBMkRtQixXQUFqQmlCLGNBQzdCLGVBQWRwQyxLQUFLSixNQUNMUSxRQUFRQyxJQUFJLDJDQUVoQkwsTUFBSyxFQUFVLElBQUlrQyxFQUErQmxDLE1BQUssRUFBYUEsS0FBS0osUUFFdkQsZUFBZEksS0FBS0osTUFDTFEsUUFBUUMsSUFBSSwrQkFFaEJMLE1BQUssRUFBVSxJQUFJK0IsRUFBbUIvQixNQUFLLEVBQWFBLEtBQUtKLE9BR2pFSSxNQUFLLEVBQVFpQyxpQkFBaUIsU0FBVTNCLElBQ3BDTixNQUFLLEVBQWtCTSxFQUFNRSxPQUFPLEdBRTVDLENBeUJBLEdBQWtCTCxHQUNJLGVBQWRILEtBQUtKLE1BQ0xRLFFBQVFDLElBQUkseUJBQTBCRixHQUcxQ0gsTUFBSyxFQUFtQmdELFNBQVNDLElBRXpCQSxFQUFTM0MsUUFBVUgsRUFBVUcsT0FDRSxtQkFBckIyQyxFQUFTRixTQUVuQkUsRUFBU0YsUUFBUTVDLEVBQ3JCLEdBRVIsRUNsR0csTUFBTStDLEVBQ1RDLHNCQUF3QixvREFFeEJDLE1BQVEsR0FDUkMsUUFBVSxHQUNWQyxLQUFPLEdBQ1BDLEtBQU8sR0FDUEMsTUFBUSxJQUVSLEdBQWEsS0FRYixXQUFBMUQsQ0FBWXVELEVBQVNELEVBQVEsR0FBSUUsRUFBTyxHQUFJQyxFQUFPLFNBQ3RCcEMsSUFBckJzQyxPQUFPQyxXQUtYMUQsS0FBS29ELE1BQVFBLEVBQ2JwRCxLQUFLcUQsUUFBVUEsRUFDZnJELEtBQUtzRCxLQUFPQSxFQUNadEQsS0FBS3VELEtBQU9BLEdBUFJuRCxRQUFRb0MsTUFBTSxtRUFRdEIsQ0FFQSxJQUFBbUIsR0FDSSxHQUF3QixPQUFwQjNELE1BQUssRUFBcUIsQ0FDMUIsSUFBSTRELEVBQVlDLFNBQVNDLGVBQWUsbUJBQ3RCLE9BQWRGLElBQ0FBLEVBQVk1RCxNQUFLLEtBRXJCQSxNQUFLLEVBQWE0RCxDQUN0QixDQUVBLE1BQU1HLEVBQWEsMkJBQTJCL0QsS0FBS29ELGlCQUM3Q1ksRUFBMEIsS0FBZGhFLEtBQUtzRCxLQUFjLFVBQVV0RCxLQUFLc0QsZUFBaUIsR0FHL0RXLEVBQVksb0JBRmUsS0FBZGpFLEtBQUt1RCxLQUFjLFlBQVl2RCxLQUFLdUQsT0FBUyw0RUFHcEN2RCxLQUFLd0Qsb0NBRXRCTyxJQUFhQyw4SEFHU2hFLEtBQUtxRCxzQkFHaENhLEVBQWVMLFNBQVNNLGNBQWMsT0FDNUNELEVBQWFFLFVBQVlILEVBRXpCLE1BQU1JLEVBQWVILEVBQWFJLGtCQUdsQ3RFLE1BQUssRUFBV3VFLFlBQVlGLEdBR2QsSUFBSVosT0FBT0MsVUFBVVIsTUFBTW1CLEdBQ25DVixPQUdOM0QsTUFBSyxFQUFXd0UsaUJBQWlCdkMsaUJBQWlCLG1CQUFtQixLQUNqRW9DLEVBQWFJLFNBQ3FCLEtBQTlCekUsTUFBSyxFQUFXb0UsWUFDaEJwRSxNQUFLLEVBQVd5RSxTQUNoQnpFLE1BQUssRUFBYSxLQUN0QixHQUVSLENBRUEsS0FDSSxNQUFNMEUsRUFBU2IsU0FBU00sY0FBYyxPQUl0QyxPQUhBTyxFQUFPQyxHQUFLLGtCQUNaRCxFQUFPRSxVQUFZMUIsRUFBTTJCLGVBQ3pCaEIsU0FBU2lCLEtBQUtDLE9BQU9MLEdBQ2RBLENBQ1gsRUMvRUcsTUFBTU0sRUFDVDVCLE1BQVEsR0FDUjZCLFFBQVUsR0FLVkMsUUFBVSxLQU1WQyxVQUFXLEVBRVhDLFlBQWMsZUFLZCxHQUFXLEtBYVgsV0FBQXRGLENBQVltRixFQUFTN0IsRUFBUSxHQUFJOEIsRUFBVSxXQUNkL0QsSUFBckJzQyxPQUFPQyxXQUtYMUQsS0FBS29ELE1BQVFBLEVBQ2JwRCxLQUFLaUYsUUFBVUEsRUFDZmpGLEtBQUtrRixRQUFVQSxHQU5YOUUsUUFBUW9DLE1BQU0sbUVBT3RCLENBRUEsSUFBQW1CLEdBQ0ksSUFBSXlCLEVBQWNwRixLQUFLb0YsWUFDbkJwRixLQUFLbUYsV0FDTEMsR0FBZSwwQkFHbkIsTUFBTUMsRUFFRiw0SUFBZUQsaUhBR2dEcEYsS0FBS29ELHVJQUdyQ3BELEtBQUtpRixrRUFNbENLLEVBQWV6QixTQUFTTSxjQUFjLE9BQzVDbUIsRUFBYWxCLFVBQVlpQixFQUN6QnJGLE1BQUssRUFBV3NGLEVBQWFoQixrQkFFN0J0RSxNQUFLLElBR0w2RCxTQUFTaUIsS0FBS1AsWUFBWXZFLE1BQUssR0FHakIsSUFBSTBELFVBQVVzQixNQUFNaEYsTUFBSyxHQUNqQzJELE9BR04zRCxNQUFLLEVBQVNpQyxpQkFBaUIsbUJBQW1CLEtBQzlDakMsTUFBSyxFQUFTeUUsUUFBUSxHQUU5QixDQUVBLEtBQ0ksTUFBTVMsRUFBVWxGLE1BQUssSUFFckIsR0FBZ0IsS0FBWmtGLEdBQWtCQSxJQUFZLEdBQzlCLE9BR0osTUFBTXRCLEVBQVk1RCxNQUFLLEVBQVN1RixjQUFjLGlCQUV2QixpQkFBWkwsRUFLUE0sTUFBTUMsUUFBUVAsSUFDZEEsRUFBUWxDLFNBQVMwQyxJQUNTLGlCQUFYQSxFQUlYOUIsRUFBVVcsWUFBWW1CLEdBSGxCOUIsRUFBVVEsV0FBYXNCLENBR0UsSUFWakM5QixFQUFVUSxVQUFZYyxDQWE5QixDQUVBLEtBQ0ksTUFBTVIsRUFBUyxHQUNmLElBQUlRLEVBQVVsRixLQUFLa0YsUUFDbkIsT0FBSUEsSUFBWSxHQUNMUixFQUdLLE9BQVpRLEVBQ08seUZBR1ksaUJBQVpBLEVBQ0FBLEdBR1BNLE1BQU1DLFFBQVFQLElBQ2RBLEVBQVFsQyxTQUFTMkMsSUFDYixHQUEwQixpQkFBZkEsRUFFUCxZQURBakIsRUFBT2tCLEtBQUtELEdBSWhCLE1BQU1ELEVBQVM3QixTQUFTTSxjQUFjLGVBQ2JoRCxJQUFyQndFLEVBQVdFLFFBQ1hILEVBQU90QixVQUFZdUIsRUFBV0UsT0FHbENILEVBQU9JLGFBQWEsWUFBK0IzRSxJQUF2QndFLEVBQVdJLFFBQXdCSixFQUFXSSxRQUFVLFVBQ3BGTCxFQUFPTSxVQUFVQyxJQUFJLFlBRUc5RSxJQUFwQndFLEVBQVdwQyxNQUNYbUMsRUFBT00sVUFBVUMsSUFBSSxPQUFTTixFQUFXcEMsV0FHYnBDLElBQTVCd0UsRUFBV08sZUFBMEQsSUFBNUJQLEVBQVdPLGNBQ3BEUixFQUFPSSxhQUFhLGtCQUFtQixjQUdoQjNFLElBQXZCd0UsRUFBV1EsU0FBdUQsbUJBQXZCUixFQUFXUSxTQUN0RFQsRUFBT3pELGlCQUFpQixTQUFVM0IsR0FBa0JxRixFQUFXUSxRQUFRN0YsS0FHM0VvRSxFQUFPa0IsS0FBS0YsRUFBTyxJQUdwQmhCLEVBQ1gsRUN3REpqQixPQUFPMkMsSUFBTSxJQW5OYixNQUVJLEdBQWUsS0FNZixlQUFBQyxHQUlJLE9BSDBCLE9BQXRCckcsTUFBSyxJQUNMQSxNQUFLLEVBQWUsSUFBSXlDLEdBRXJCekMsTUFBSyxDQUNoQixDQVdBLE9BQUFzRyxDQUFRbEQsRUFBTzZCLEVBQVNwQyxFQUFVMEQsRUFBVSxLQUFNQyxFQUFjLFVBQzVEeEcsS0FBS3lHLE1BQU1yRCxFQUFPNkIsRUFBUyxDQUN2QixDQUFDWSxNQUFPVSxFQUFTSixRQUFVN0YsR0FBa0J1QyxFQUFTdkMsR0FBU2lELEtBQU0sVUFBVzJDLGNBQWMsR0FDOUYsQ0FBQ0wsTUFBT1csRUFBYU4sY0FBYyxFQUFNM0MsS0FBTSxjQUV2RCxDQWVBLFFBQUFtRCxDQUFTekIsRUFBUzdCLEVBQVEsR0FBSThCLEVBQVMsTUFDbkMsT0FBTyxJQUFJRixFQUFNQyxFQUFTN0IsRUFBTzhCLEVBQ3JDLENBZUEsS0FBQXVCLENBQU14QixFQUFTN0IsRUFBUSxHQUFJOEIsRUFBUyxNQUNoQyxNQUFNdUIsRUFBUXpHLEtBQUswRyxTQUFTekIsRUFBUzdCLEVBQU84QixHQUU1QyxPQURBdUIsRUFBTTlDLE9BQ0M4QyxDQUNYLENBVUEsUUFBQUUsQ0FBU3RELEVBQVNELEVBQVEsR0FBSUUsRUFBTyxHQUFJQyxFQUFPLElBQzVDLE9BQU8sSUFBSUwsRUFBTUcsRUFBU0QsRUFBT0UsRUFBTUMsRUFDM0MsQ0FVQSxLQUFBcUQsQ0FBTXZELEVBQVNELEVBQVEsR0FBSUUsRUFBTyxHQUFJQyxFQUFPLEdBQUlDLEVBQVEsS0FDckQsTUFBTW9ELEVBQVE1RyxLQUFLMkcsU0FBU3RELEVBQVNELEVBQU9FLEVBQU1DLEdBT2xELE9BTGMsT0FBVkMsSUFDQW9ELEVBQU1wRCxNQUFRQSxHQUdsQm9ELEVBQU1qRCxPQUNDaUQsQ0FDWCxDQWVBLGNBQU1DLENBQVNDLEdBQ1gsSUFBS0EsRUFDRCxNQUFPLENBQUMsT0FHWTNGLElBQXBCbkIsS0FBSytHLGFBQ0wvRyxLQUFLK0csV0FBYSxDQUFDLEdBR3ZCLElBQUlDLEVBQWEsSUFFRyxpQkFBVEYsR0FBcUJBLGFBQWdCRyxVQUM1Q0gsRUFBTyxDQUFDQSxJQUdaLElBQUssSUFBSUksS0FBUUosRUFDUEksS0FBUWxILEtBQUsrRyxZQUNmQyxFQUFXcEIsS0FBS3NCLEdBSXhCLEdBQUlGLEVBQVdHLE9BQVMsRUFBRyxDQUV2QixJQUFJQyxFQUFTLElBQUlDLGdCQUFnQixDQUFDQyxFQUFHLE9BQVFDLEVBQUcsUUFFaERQLEVBQVdoRSxTQUFRLENBQUNrRSxFQUFNTSxFQUFPQyxLQUM3QkwsRUFBT3JDLE9BQU8sUUFBVXlDLEVBQVEsSUFBS04sRUFBSyxJQUU5Q0UsRUFBT3JDLE9BQU8sUUFBUyxHQUN2QixJQUNJLElBQUkyQyxRQUFpQkMsTUFBTSxhQUFlUCxFQUFPUSxZQUVqRCxHQUFJRixFQUFTRyxHQUFJLENBQ2IsTUFBTUMsUUFBcUJKLEVBQVNLLE9BQ3BDLEdBQUlELEVBQWFFLFFBQ2IsSUFBSyxNQUFNQyxLQUFPSCxFQUFhckgsS0FDM0JULEtBQUsrRyxXQUFXa0IsR0FBT0gsRUFBYXJILEtBQUt3SCxFQUlyRCxDQUdKLENBQUUsTUFBT3pGLEdBRVQsQ0FDSixDQUVBLElBQUlrQyxFQUFTLENBQUMsRUFDZCxJQUFLLElBQUl3QyxLQUFRSixFQUNSSSxLQUFRbEgsS0FBSytHLGFBQ2RyQyxFQUFPd0MsR0FBUWxILEtBQUsrRyxXQUFXRyxJQUl2QyxPQUFPeEMsQ0FDWCxDQUtBLFdBQUF3RCxHQUNJbEksS0FBSzZHLFNBQVMsQ0FBQyxVQUFXLE1BQU1zQixNQUFLekQsSUFDakMsSUFBSTBELEVBQWtCdkUsU0FBU3dFLGlCQUFpQix5QkFDaEQsSUFBSyxJQUFJQyxLQUFXRixFQUFpQixDQUNqQ0UsRUFBUWxFLFVBQVlNLEVBQU82RCxRQUMzQnZJLEtBQUt3SSxzQkFBc0JGLEdBQzNCQSxFQUFRdEMsVUFBVXZCLE9BQU8sdUJBQXdCLFdBQ2pENkQsRUFBUXRDLFVBQVVDLElBQUksV0FFdEIsTUFBTXdDLEVBQU9ILEVBQVFJLFFBQVEsUUFDN0IsR0FBYSxPQUFURCxFQUFlLENBQ2YsSUFBSUUsRUFBU0YsRUFBS2xELGNBQWMsa0NBQ2pCLE9BQVhvRCxHQUNBQSxFQUFPN0MsYUFBYSxRQUFTcEIsRUFBT2tFLEVBRTVDLENBQ0osSUFFUixDQU9BLHFCQUFBSixDQUFzQkssR0FDbEIsTUFBTUMsRUFBaUJELEVBQWlCUixpQkFBaUIsVUFFekQ3QyxNQUFNdUQsS0FBS0QsR0FBZ0I5RixTQUFTZ0csSUFDaEMsTUFBTUMsRUFBZ0JwRixTQUFTTSxjQUFjLFVBQzdDcUIsTUFBTXVELEtBQUtDLEVBQWNFLFlBQVlsRyxTQUFTbUcsSUFDMUNGLEVBQWNuRCxhQUFhcUQsRUFBVXZHLEtBQU11RyxFQUFVQyxNQUFNLElBRS9ESCxFQUFjSSxLQUFPTCxFQUFjSyxLQUNuQ0wsRUFBY00sV0FBV0MsYUFBYU4sRUFBZUQsRUFBYyxHQUUzRSxFOztBQ3ZOSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJiYXNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBwYWNrYWdlIENvdG9udGlcclxuICogQGNvcHlyaWdodCAoYykgQ290b250aSBUZWFtXHJcbiAqIEBsaWNlbnNlIGh0dHBzOi8vZ2l0aHViLmNvbS9Db3RvbnRpL0NvdG9udGkvYmxvYi9tYXN0ZXIvTGljZW5zZS50eHRcclxuICovIiwiLy8gaW1wb3J0IHtTZXJ2ZXJFdmVudHNTU0VEcml2ZXJ9IGZyb20gXCIuL1NlcnZlckV2ZW50c1NTRURyaXZlclwiO1xyXG4vLyBpbXBvcnQge1NlcnZlckV2ZW50c0FqYXhEcml2ZXJ9IGZyb20gXCIuL1NlcnZlckV2ZW50c0FqYXhEcml2ZXJcIjtcclxuXHJcbi8qKlxyXG4gKiBCYXNlIHNlcnZlciBldmVudHMgZHJpdmVyXHJcbiAqIEBwYWNrYWdlIENvdG9udGlcclxuICogQGNvcHlyaWdodCAoYykgQ290b250aSBUZWFtXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQmFzZVNlcnZlckV2ZW50c0RyaXZlciBleHRlbmRzIEV2ZW50VGFyZ2V0IHtcclxuICAgIG1vZGUgPSAncHJvZHVjdGlvbic7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfG51bGx9XHJcbiAgICAgKi9cclxuICAgIGV2ZW50c1VybCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoZXZlbnRzVXJsLCBtb2RlID0gJycpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG5cclxuICAgICAgICBpZiAobW9kZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLm1vZGUgPSBtb2RlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmV2ZW50c1VybCA9IGV2ZW50c1VybDtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCkgeyB9XHJcblxyXG4gICAgb25FdmVudFRyaWdnZXJlZChldmVudERhdGEpIHtcclxuICAgICAgICBpZiAodGhpcy5tb2RlICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlcnZlckV2ZW50c0RyaXZlcjogU2VydmVyIHRyaWdnZXJlZCBldmVudCcsIGV2ZW50RGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudCgnZXZlbnQnLCB7XHJcbiAgICAgICAgICAgIGRldGFpbDogZXZlbnREYXRhLFxyXG4gICAgICAgICAgICBkYXRhOiB7YmFyOiAnYmF6J31cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtCYXNlU2VydmVyRXZlbnRzRHJpdmVyfSBmcm9tIFwiLi9CYXNlU2VydmVyRXZlbnRzRHJpdmVyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2VydmVyRXZlbnRzQWpheERyaXZlciBleHRlbmRzIEJhc2VTZXJ2ZXJFdmVudHNEcml2ZXIge1xyXG5cclxufSIsImltcG9ydCB7QmFzZVNlcnZlckV2ZW50c0RyaXZlcn0gZnJvbSBcIi4vQmFzZVNlcnZlckV2ZW50c0RyaXZlclwiO1xyXG5cclxuLyoqXHJcbiAqIFNlcnZlciBzZW50IGV2ZW50cyBkcml2ZXJcclxuICogQHBhY2thZ2UgQ290b250aVxyXG4gKiBAY29weXJpZ2h0IChjKSBDb3RvbnRpIFRlYW1cclxuICogQGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1NlcnZlci1zZW50X2V2ZW50cy9Vc2luZ19zZXJ2ZXItc2VudF9ldmVudHNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBTZXJ2ZXJFdmVudHNTU0VEcml2ZXIgZXh0ZW5kcyBCYXNlU2VydmVyRXZlbnRzRHJpdmVyIHtcclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge0V2ZW50U291cmNlfG51bGx9XHJcbiAgICAgKi9cclxuICAgICNldmVudFNvdXJjZSA9IG51bGw7XHJcblxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICBpZiAodGhpcy4jZXZlbnRTb3VyY2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpbml0IFNlcnZlckV2ZW50c1NTRURyaXZlci4gJywgdGhpcy5ldmVudHNVcmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4jZXZlbnRTb3VyY2UgPSBuZXcgRXZlbnRTb3VyY2UodGhpcy5ldmVudHNVcmwpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5tb2RlICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgdGhpcy4jZXZlbnRTb3VyY2Uub25vcGVuID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmVyRXZlbnRzU1NFRHJpdmVyIGNvbm5lY3Rpb24gaXMgb3BlbicpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4jZXZlbnRTb3VyY2Uub25tZXNzYWdlID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50RGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XHJcbiAgICAgICAgICAgIGlmIChldmVudERhdGEuZGF0YSAhPT0gdW5kZWZpbmVkICYmICh0eXBlb2YgZXZlbnREYXRhLmRhdGEgPT09ICdzdHJpbmcnKSAmJiBldmVudERhdGEuZGF0YSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50RGF0YS5kYXRhID0gSlNPTi5wYXJzZShldmVudERhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZXZlbnREYXRhLmV2ZW50SWQgPSBldmVudC5sYXN0RXZlbnRJZDtcclxuICAgICAgICAgICAgdGhpcy5vbkV2ZW50VHJpZ2dlcmVkKGV2ZW50RGF0YSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuI2V2ZW50U291cmNlLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTZXJ2ZXJFdmVudHNTU0VEcml2ZXIgY29ubmVjdGlvbiBlcnJvcicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiLyoqXHJcbiAqIEJhc2Ugc2VydmVyIGV2ZW50cyBjbGllbnRcclxuICovXHJcbmV4cG9ydCBjbGFzcyBCYXNlU2VydmVyRXZlbnRzQ2xpZW50IGV4dGVuZHMgRXZlbnRUYXJnZXQge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfG51bGx9XHJcbiAgICAgKi9cclxuICAgIG1vZGUgPSAncHJvZHVjdGlvbic7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICovXHJcbiAgICBkcml2ZXJUeXBlID0gJyc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZHJpdmVyVHlwZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd8bnVsbH0gbW9kZVxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihkcml2ZXJUeXBlLCBtb2RlID0gbnVsbCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcblxyXG4gICAgICAgIHRoaXMuZHJpdmVyVHlwZSA9IGRyaXZlclR5cGU7XHJcblxyXG4gICAgICAgIGlmIChtb2RlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZSA9IG1vZGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkV2ZW50VHJpZ2dlcmVkKGV2ZW50RGF0YSkge1xyXG4gICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmVyRXZlbnRzQ2xpZW50OiBTZXJ2ZXIgdHJpZ2dlcmVkIGV2ZW50JywgZXZlbnREYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdldmVudCcsIHtkZXRhaWw6IGV2ZW50RGF0YX0pO1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge1NlcnZlckV2ZW50c1NTRURyaXZlcn0gZnJvbSBcIi4vU2VydmVyRXZlbnRzU1NFRHJpdmVyXCI7XHJcbmltcG9ydCB7U2VydmVyRXZlbnRzQWpheERyaXZlcn0gZnJvbSBcIi4vU2VydmVyRXZlbnRzQWpheERyaXZlclwiO1xyXG5cclxuLyoqXHJcbiAqIEJhc2Ugc2VydmVyIGV2ZW50cyBkcml2ZXJcclxuICogQHBhY2thZ2UgQ290b250aVxyXG4gKiBAY29weXJpZ2h0IChjKSBDb3RvbnRpIFRlYW1cclxuICovXHJcbmV4cG9ydCBjbGFzcyBTZXJ2ZXJFdmVudHNEcml2ZXJGYWN0b3J5IHtcclxuICAgICNiYXNlVXJsID0gJy8nO1xyXG5cclxuICAgICNtb2RlID0gJ3Byb2R1Y3Rpb24nXHJcblxyXG4gICAgY29uc3RydWN0b3IoYmFzZVVybCA9IG51bGwsIG1vZGUgPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKGJhc2VVcmwgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy4jYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtb2RlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuI21vZGUgPSBtb2RlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkcml2ZXJUeXBlXHJcbiAgICAgKiBAcmV0dXJucyB7U2VydmVyRXZlbnRzU1NFRHJpdmVyfFNlcnZlckV2ZW50c0FqYXhEcml2ZXJ9XHJcbiAgICAgKi9cclxuICAgIGdldEJ5VHlwZShkcml2ZXJUeXBlKSB7XHJcbiAgICAgICAgbGV0IGRyaXZlciA9IG51bGw7XHJcblxyXG4gICAgICAgIGNvbnN0IHNlcnZlclNlbnRFdmVudHNVcmwgPSB0aGlzLiNiYXNlVXJsICsgJz9uPXNlcnZlci1ldmVudHMmYT1zc2UnO1xyXG4gICAgICAgIGNvbnN0IGFqYXhFdmVudHNVcmwgPSB0aGlzLiNiYXNlVXJsICsgJz9uPXNlcnZlci1ldmVudHMmYT1hamF4JztcclxuXHJcbiAgICAgICAgc3dpdGNoIChkcml2ZXJUeXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3NlcnZlclNlbnRFdmVudHMnOlxyXG4gICAgICAgICAgICAgICAgZHJpdmVyID0gbmV3IFNlcnZlckV2ZW50c1NTRURyaXZlcihzZXJ2ZXJTZW50RXZlbnRzVXJsKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLiNtb2RlICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXNpbmcgU2VydmVyRXZlbnRzU1NFRHJpdmVyJywgc2VydmVyU2VudEV2ZW50c1VybCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBkcml2ZXIgPSBuZXcgU2VydmVyRXZlbnRzQWpheERyaXZlcihhamF4RXZlbnRzVXJsKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLiNtb2RlICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXNpbmcgU2VydmVyRXZlbnRzQWpheERyaXZlcicsIGFqYXhFdmVudHNVcmwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGRyaXZlcjtcclxuICAgIH1cclxufSIsImltcG9ydCB7QmFzZVNlcnZlckV2ZW50c0NsaWVudH0gZnJvbSBcIi4vQmFzZVNlcnZlckV2ZW50c0NsaWVudFwiO1xyXG5pbXBvcnQge1NlcnZlckV2ZW50c0RyaXZlckZhY3Rvcnl9IGZyb20gXCIuLi9kcml2ZXIvU2VydmVyRXZlbnRzRHJpdmVyRmFjdG9yeVwiO1xyXG5cclxuLyoqXHJcbiAqIFNlcnZlciBldmVudHMgY2xpZW50XHJcbiAqIEBwYWNrYWdlIENvdG9udGlcclxuICogQGNvcHlyaWdodCAoYykgQ290b250aSBUZWFtXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgU2VydmVyRXZlbnRzQ2xpZW50IGV4dGVuZHMgQmFzZVNlcnZlckV2ZW50c0NsaWVudCB7XHJcbiAgICBpbml0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaW5pdCBTZXJ2ZXJFdmVudHNDbGllbnQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGZhY3RvcnkgPSBuZXcgU2VydmVyRXZlbnRzRHJpdmVyRmFjdG9yeShnZXRCYXNlSHJlZigpLCB0aGlzLm1vZGUpO1xyXG5cclxuICAgICAgICBjb25zdCBkcml2ZXIgPSBmYWN0b3J5LmdldEJ5VHlwZSh0aGlzLmRyaXZlclR5cGUsIHRoaXMubW9kZSk7XHJcbiAgICAgICAgZHJpdmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2V2ZW50JywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub25FdmVudFRyaWdnZXJlZChldmVudC5kZXRhaWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRyaXZlci5pbml0KCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge0Jhc2VTZXJ2ZXJFdmVudHNDbGllbnR9IGZyb20gXCIuL0Jhc2VTZXJ2ZXJFdmVudHNDbGllbnRcIjtcclxuXHJcbi8qKlxyXG4gKiBTaGFyZWQgd29ya2VyIHNlcnZlciBldmVudHMgY2xpZW50XHJcbiAqIEBwYWNrYWdlIENvdG9udGlcclxuICogQGNvcHlyaWdodCAoYykgQ290b250aSBUZWFtXHJcbiAqIEBsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9TaGFyZWRXb3JrZXJcclxuICovXHJcbmV4cG9ydCBjbGFzcyBTZXJ2ZXJFdmVudHNTaGFyZWRXb3JrZXJDbGllbnQgZXh0ZW5kcyBCYXNlU2VydmVyRXZlbnRzQ2xpZW50IHtcclxuICAgIGluaXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpbml0IFNlcnZlckV2ZW50c1NoYXJlZFdvcmtlckNsaWVudCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3Qgd29ya2VyID0gbmV3IFNoYXJlZFdvcmtlcignL2pzL3NoYXJlZFdvcmtlclNlcnZlckV2ZW50cy5taW4uanMnKTtcclxuICAgICAgICAgICAgY29uc3QgcG9ydCA9IHdvcmtlci5wb3J0O1xyXG5cclxuICAgICAgICAgICAgcG9ydC5wb3N0TWVzc2FnZSh7Y29uZmlnOiB7bW9kZTogdGhpcy5tb2RlLCBkcml2ZXI6IHRoaXMuZHJpdmVyVHlwZSwgYmFzZVVybDogZ2V0QmFzZUhyZWYoKX19KTtcclxuXHJcbiAgICAgICAgICAgIHBvcnQub25tZXNzYWdlID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RlICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmVyU2VudEV2ZW50c1NoYXJlZFdvcmtlciBldmVudCcsIGV2ZW50LmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50VHJpZ2dlcmVkKGV2ZW50LmRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsIi8vaW1wb3J0IHtCYXNlU2VydmVyRXZlbnRzRHJpdmVyfSBmcm9tIFwiLi9kcml2ZXIvQmFzZVNlcnZlckV2ZW50c0RyaXZlclwiO1xyXG5pbXBvcnQge1NlcnZlckV2ZW50c0FqYXhEcml2ZXJ9IGZyb20gXCIuL2RyaXZlci9TZXJ2ZXJFdmVudHNBamF4RHJpdmVyXCI7XHJcbmltcG9ydCB7U2VydmVyRXZlbnRzU1NFRHJpdmVyfSBmcm9tIFwiLi9kcml2ZXIvU2VydmVyRXZlbnRzU1NFRHJpdmVyXCI7XHJcbmltcG9ydCB7U2VydmVyRXZlbnRzQ2xpZW50fSBmcm9tIFwiLi9jbGllbnQvU2VydmVyRXZlbnRzQ2xpZW50XCI7XHJcbmltcG9ydCB7U2VydmVyRXZlbnRzU2hhcmVkV29ya2VyQ2xpZW50fSBmcm9tIFwiLi9jbGllbnQvU2VydmVyRXZlbnRzU2hhcmVkV29ya2VyQ2xpZW50XCI7XHJcblxyXG4vKipcclxuICogU2VydmVyIGV2ZW50c1xyXG4gKiBAcGFja2FnZSBDb3RvbnRpXHJcbiAqIEBjb3B5cmlnaHQgKGMpIENvdG9udGkgVGVhbVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFNlcnZlckV2ZW50cyB7XHJcbiAgICBtb2RlID0gJ3Byb2R1Y3Rpb24nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge251bGx8U2VydmVyRXZlbnRzU2hhcmVkV29ya2VyQ2xpZW50fFNlcnZlckV2ZW50c0NsaWVudH1cclxuICAgICAqL1xyXG4gICAgI2NsaWVudCA9IG51bGw7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICovXHJcbiAgICAjY2xpZW50VHlwZSA9ICdzaGFyZWRXb3JrZXInO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ30gJ3NlcnZlclNlbnRFdmVudHMnLCAnYWpheCcgb3IgJ3dlYnNvY2tldCcgKG5vdCBpbXBsZW1lbnRlZCB5ZXQpXHJcbiAgICAgKi9cclxuICAgICNkcml2ZXJUeXBlID0gJ3NlcnZlclNlbnRFdmVudHMnO1xyXG5cclxuICAgICNvYnNlcnZlcnNSZWdpc3RyeSA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy4jb2JzZXJ2ZXJzUmVnaXN0cnkgPSBuZXcgTWFwKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50XHJcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFja1xyXG4gICAgICovXHJcbiAgICBhZGRPYnNlcnZlcihuYW1lLCBldmVudCwgY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLiNvYnNlcnZlcnNSZWdpc3RyeS5zZXQobmFtZSwge1xyXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICBldmVudDogZXZlbnQsXHJcbiAgICAgICAgICAgIG9uRXZlbnQ6IGNhbGxiYWNrXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLiNjbGllbnQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy4jaW5pdENsaWVudCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAjaW5pdENsaWVudCgpIHtcclxuICAgICAgICBpZiAodGhpcy4jY2xpZW50VHlwZSA9PT0gJ3NoYXJlZFdvcmtlcicgJiYgKHR5cGVvZiBTaGFyZWRXb3JrZXIgIT09IHVuZGVmaW5lZCkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRpbmcgU2VydmVyRXZlbnRzU2hhcmVkV29ya2VyQ2xpZW50Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy4jY2xpZW50ID0gbmV3IFNlcnZlckV2ZW50c1NoYXJlZFdvcmtlckNsaWVudCh0aGlzLiNkcml2ZXJUeXBlLCB0aGlzLm1vZGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0aW5nIFNlcnZlckV2ZW50c0NsaWVudCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuI2NsaWVudCA9IG5ldyBTZXJ2ZXJFdmVudHNDbGllbnQodGhpcy4jZHJpdmVyVHlwZSwgdGhpcy5tb2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuI2NsaWVudC5hZGRFdmVudExpc3RlbmVyKCdldmVudCcsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLiNvbkV2ZW50VHJpZ2dlcmVkKGV2ZW50LmRldGFpbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcmV0dXJucyB7U2VydmVyRXZlbnRzU1NFRHJpdmVyfFNlcnZlckV2ZW50c0FqYXhEcml2ZXJ9XHJcbiAgICAgKi9cclxuICAgIC8vICNnZXREcml2ZXIoKSB7XHJcbiAgICAvLyAgICAgbGV0IGRyaXZlciA9IG51bGw7XHJcbiAgICAvLyAgICAgc3dpdGNoICh0aGlzLiNkcml2ZXJUeXBlKSB7XHJcbiAgICAvLyAgICAgICAgIGNhc2UgJ3NlcnZlclNlbnRFdmVudHMnOlxyXG4gICAgLy8gICAgICAgICAgICAgZHJpdmVyID0gbmV3IFNlcnZlckV2ZW50c1NTRURyaXZlcih0aGlzLiNzZXJ2ZXJTZW50RXZlbnRzVXJsLCB0aGlzLm1vZGUpO1xyXG4gICAgLy8gICAgICAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAvLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzaW5nIFNlcnZlckV2ZW50c1NTRURyaXZlcicpO1xyXG4gICAgLy8gICAgICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAvL1xyXG4gICAgLy8gICAgICAgICBkZWZhdWx0OlxyXG4gICAgLy8gICAgICAgICAgICAgZHJpdmVyID0gbmV3IFNlcnZlckV2ZW50c0FqYXhEcml2ZXIodGhpcy4jc2VydmVyU2VudEV2ZW50c1VybCwgdGhpcy5tb2RlKTtcclxuICAgIC8vICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2luZyBTZXJ2ZXJFdmVudHNBamF4RHJpdmVyJyk7XHJcbiAgICAvLyAgICAgICAgICAgICB9XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy9cclxuICAgIC8vICAgICByZXR1cm4gZHJpdmVyO1xyXG4gICAgLy8gfVxyXG5cclxuICAgICNvbkV2ZW50VHJpZ2dlcmVkKGV2ZW50RGF0YSkge1xyXG4gICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmVyIHRyaWdnZXJlZCBldmVudCcsIGV2ZW50RGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiNvYnNlcnZlcnNSZWdpc3RyeS5mb3JFYWNoKChvYnNlcnZlcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5ldmVudCA9PT0gZXZlbnREYXRhLmV2ZW50XHJcbiAgICAgICAgICAgICAgICAmJiB0eXBlb2Ygb2JzZXJ2ZXIub25FdmVudCA9PT0gJ2Z1bmN0aW9uJ1xyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyLm9uRXZlbnQoZXZlbnREYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiLyoqXHJcbiAqIFRvYXN0XHJcbiAqIFNob3cgVG9hc3RzIHByb2dyYW1tYXRpY2FsbHlcclxuICogQHBhY2thZ2UgQ290b250aVxyXG4gKiBAY29weXJpZ2h0IChjKSBDb3RvbnRpIFRlYW1cclxuICpcclxuICogQGxpbmsgaHR0cHM6Ly9nZXRib290c3RyYXAuY29tL2RvY3MvNS4zL2NvbXBvbmVudHMvdG9hc3RzL1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFRvYXN0IHtcclxuICAgIHN0YXRpYyBjb250YWluZXJDbGFzcyA9ICd0b2FzdC1jb250YWluZXIgcG9zaXRpb24tZml4ZWQgYm90dG9tLTAgZW5kLTAgcC0zJztcclxuXHJcbiAgICB0aXRsZSA9ICcnO1xyXG4gICAgbWVzc2FnZSA9ICcnO1xyXG4gICAgaGludCA9ICcnO1xyXG4gICAgdHlwZSA9ICcnO1xyXG4gICAgZGVsYXkgPSA1MDAwO1xyXG5cclxuICAgICNjb250YWluZXIgPSBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2VcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0aXRsZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGhpbnRcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIHRpdGxlID0gJycsIGhpbnQgPSAnJywgdHlwZSA9ICcnKSB7XHJcbiAgICAgICAgaWYgKHdpbmRvdy5ib290c3RyYXAgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdCb290c3RyYXAgaXMgbm90IGZvdW5kLiBJdCBpcyByZXF1aXJlZCBmb3IgdXNlIFwiVG9hc3RcIiBjb21wb25lbnQnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XHJcbiAgICAgICAgdGhpcy5oaW50ID0gaGludDtcclxuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3coKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuI2NvbnRhaW5lciA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0LWNvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICBpZiAoY29udGFpbmVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIgPSB0aGlzLiNjcmVhdGVDb250YWluZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLiNjb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0b2FzdFRpdGxlID0gYDxzdHJvbmcgY2xhc3M9XCJtZS1hdXRvXCI+JHt0aGlzLnRpdGxlfTwvc3Ryb25nPmA7XHJcbiAgICAgICAgY29uc3QgdG9hc3RIaW50ID0gdGhpcy5oaW50ICE9PSAnJyA/IGA8c21hbGw+JHt0aGlzLmhpbnR9PC9zbWFsbD5gIDogJyc7XHJcbiAgICAgICAgY29uc3QgYmFja0dyb3VuZCA9IHRoaXMudHlwZSAhPT0gJycgPyBgIHRleHQtYmctJHt0aGlzLnR5cGV9YCA6ICcnO1xyXG5cclxuICAgICAgICBjb25zdCB0b2FzdEhUTUwgPSBgPGRpdiBjbGFzcz1cInRvYXN0JHtiYWNrR3JvdW5kfVwiIHJvbGU9XCJhbGVydFwiIGFyaWEtbGl2ZT1cImFzc2VydGl2ZVwiIGFyaWEtYXRvbWljPVwidHJ1ZVwiIGBcclxuICAgICAgICAgICAgICAgICsgYGRhdGEtYnMtZGVsYXk9XCIke3RoaXMuZGVsYXl9XCI+YFxyXG4gICAgICAgICAgICArICc8ZGl2IGNsYXNzPVwidG9hc3QtaGVhZGVyXCI+J1xyXG4gICAgICAgICAgICAgICsgYCR7dG9hc3RUaXRsZX0ke3RvYXN0SGludH1gXHJcbiAgICAgICAgICAgICAgKyAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4tY2xvc2VcIiBkYXRhLWJzLWRpc21pc3M9XCJ0b2FzdFwiIGFyaWEtbGFiZWw9XCJDbG9zZVwiPjwvYnV0dG9uPidcclxuICAgICAgICAgICAgKyAnPC9kaXY+J1xyXG4gICAgICAgICAgICArIGA8ZGl2IGNsYXNzPVwidG9hc3QtYm9keVwiPiR7dGhpcy5tZXNzYWdlfTwvZGl2PmBcclxuICAgICAgICAgICsgJzwvZGl2Pic7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvYXN0V3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHRvYXN0V3JhcHBlci5pbm5lckhUTUwgPSB0b2FzdEhUTUw7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvYXN0RWxlbWVudCA9IHRvYXN0V3JhcHBlci5maXJzdEVsZW1lbnRDaGlsZDtcclxuXHJcbiAgICAgICAgLy8gQXBwZW5kIHRoZSB0b2FzdCB0byB0aGUgY29udGFpbmVyXHJcbiAgICAgICAgdGhpcy4jY29udGFpbmVyLmFwcGVuZENoaWxkKHRvYXN0RWxlbWVudCk7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIHRvYXN0XHJcbiAgICAgICAgY29uc3QgdG9hc3QgPSBuZXcgd2luZG93LmJvb3RzdHJhcC5Ub2FzdCh0b2FzdEVsZW1lbnQpO1xyXG4gICAgICAgIHRvYXN0LnNob3coKTtcclxuXHJcbiAgICAgICAgLy8gT3B0aW9uYWxseSByZW1vdmUgdGhlIHRvYXN0IGZyb20gdGhlIERPTSBhZnRlciBpdCBoaWRlc1xyXG4gICAgICAgIHRoaXMuI2NvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkLmFkZEV2ZW50TGlzdGVuZXIoJ2hpZGRlbi5icy50b2FzdCcsICgpID0+IHtcclxuICAgICAgICAgICAgdG9hc3RFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy4jY29udGFpbmVyLmlubmVySFRNTCA9PT0gJycpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuI2NvbnRhaW5lci5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuI2NvbnRhaW5lciA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAjY3JlYXRlQ29udGFpbmVyKCkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHJlc3VsdC5pZCA9ICd0b2FzdC1jb250YWluZXInO1xyXG4gICAgICAgIHJlc3VsdC5jbGFzc05hbWUgPSBUb2FzdC5jb250YWluZXJDbGFzcztcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZChyZXN1bHQpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbn0iLCIvKipcclxuICogTW9kYWxcclxuICogU2hvdyBNb2RhbCBwcm9ncmFtbWF0aWNhbGx5XHJcbiAqIEBwYWNrYWdlIENvdG9udGlcclxuICogQGNvcHlyaWdodCAoYykgQ290b250aSBUZWFtXHJcbiAqXHJcbiAqIEBsaW5rIGh0dHBzOi8vZ2V0Ym9vdHN0cmFwLmNvbS9kb2NzLzUuMy9jb21wb25lbnRzL21vZGFsL1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE1vZGFsIHtcclxuICAgIHRpdGxlID0gJyc7XHJcbiAgICBjb250ZW50ID0gJyc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7KHtsYWJlbDogU3RyaW5nLCBvbkNsaWNrOiBmdW5jdGlvbiwgY2xvc2VPbkNsaWNrOiBib29sLCB0eXBlOiBzdHJpbmd9fHN0cmluZylbXXxudWxsfVxyXG4gICAgICovXHJcbiAgICBidXR0b25zID0gbnVsbDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFZlcnRpY2FsbHkgY2VudGVyZWRcclxuICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBjZW50ZXJlZCA9IGZhbHNlO1xyXG5cclxuICAgIGRpYWxvZ0NsYXNzID0gJ21vZGFsLWRpYWxvZyc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7RWxlbWVudH1cclxuICAgICAqL1xyXG4gICAgI2VsZW1lbnQgPSBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbnRlbnRcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0aXRsZVxyXG4gICAgICogQHBhcmFtIHsoe1xyXG4gICAgICogICAgbGFiZWw6IFN0cmluZyxcclxuICAgICAqICAgIG9uQ2xpY2s6IGZ1bmN0aW9ufHVuZGVmaW5lZCxcclxuICAgICAqICAgIGNsb3NlT25DbGljazogYm9vbHx1bmRlZmluZWQsXHJcbiAgICAgKiAgICB0eXBlOiBzdHJpbmd8dW5kZWZpbmVkLFxyXG4gICAgICogICAgYnRuVHlwZTogc3RyaW5nfHVuZGVmaW5lZFxyXG4gICAgICogIH18c3RyaW5nKVtdfG51bGx9IGJ1dHRvbnNcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoY29udGVudCwgdGl0bGUgPSAnJywgYnV0dG9ucyA9IG51bGwpIHtcclxuICAgICAgICBpZiAod2luZG93LmJvb3RzdHJhcCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Jvb3RzdHJhcCBpcyBub3QgZm91bmQuIEl0IGlzIHJlcXVpcmVkIGZvciB1c2UgXCJNb2RhbFwiIGNvbXBvbmVudCcpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5jb250ZW50ID0gY29udGVudDtcclxuICAgICAgICB0aGlzLmJ1dHRvbnMgPSBidXR0b25zO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3coKSB7XHJcbiAgICAgICAgbGV0IGRpYWxvZ0NsYXNzID0gdGhpcy5kaWFsb2dDbGFzcztcclxuICAgICAgICBpZiAodGhpcy5jZW50ZXJlZCkge1xyXG4gICAgICAgICAgICBkaWFsb2dDbGFzcyArPSAnIG1vZGFsLWRpYWxvZy1jZW50ZXJlZCc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBtb2RhbEhUTUwgPSAnPGRpdiBjbGFzcz1cIm1vZGFsIGZhZGVcIiBpZD1cIkNvdG9udGlEeW5hbWljTW9kYWxcIiB0YWJpbmRleD1cIi0xXCIgJ1xyXG4gICAgICAgICAgICAgICAgKyAnYXJpYS1sYWJlbGxlZGJ5PVwiQ290b250aUR5bmFtaWNNb2RhbExhYmVsXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+J1xyXG4gICAgICAgICAgKyBgPGRpdiBjbGFzcz1cIiR7ZGlhbG9nQ2xhc3N9XCI+YFxyXG4gICAgICAgICAgICArICc8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPidcclxuICAgICAgICAgICAgICArICc8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+J1xyXG4gICAgICAgICAgICAgICAgKyBgPGg1IGNsYXNzPVwibW9kYWwtdGl0bGVcIiBpZD1cIkNvdG9udGlEeW5hbWljTW9kYWxMYWJlbFwiPiR7dGhpcy50aXRsZX08L2g1PmBcclxuICAgICAgICAgICAgICAgICsgJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuLWNsb3NlXCIgZGF0YS1icy1kaXNtaXNzPVwibW9kYWxcIiBhcmlhLWxhYmVsPVwiQ2xvc2VcIj48L2J1dHRvbj4nXHJcbiAgICAgICAgICAgICAgKyAnPC9kaXY+J1xyXG4gICAgICAgICAgICAgICsgYDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+JHt0aGlzLmNvbnRlbnR9PC9kaXY+YFxyXG4gICAgICAgICAgICAgICsgJzxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj48L2Rpdj4nXHJcbiAgICAgICAgICAgICsgJzwvZGl2PidcclxuICAgICAgICAgICsgJzwvZGl2PidcclxuICAgICAgICArICc8L2Rpdj4nO1xyXG5cclxuICAgICAgICBjb25zdCBtb2RhbFdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBtb2RhbFdyYXBwZXIuaW5uZXJIVE1MID0gbW9kYWxIVE1MO1xyXG4gICAgICAgIHRoaXMuI2VsZW1lbnQgPSBtb2RhbFdyYXBwZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcblxyXG4gICAgICAgIHRoaXMuI2FkZEJ1dHRvbnMoKTtcclxuXHJcbiAgICAgICAgLy8gQXBwZW5kIHRoZSBtb2RhbCB0byB0aGUgYm9keVxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy4jZWxlbWVudCk7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgYW5kIHNob3cgdGhlIG1vZGFsXHJcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgYm9vdHN0cmFwLk1vZGFsKHRoaXMuI2VsZW1lbnQpO1xyXG4gICAgICAgIG1vZGFsLnNob3coKTtcclxuXHJcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBtb2RhbCBmcm9tIHRoZSBET00gYWZ0ZXIgaXQgaXMgaGlkZGVuXHJcbiAgICAgICAgdGhpcy4jZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdoaWRkZW4uYnMubW9kYWwnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuI2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgI2FkZEJ1dHRvbnMoKSB7XHJcbiAgICAgICAgY29uc3QgYnV0dG9ucyA9IHRoaXMuI2J1aWxkQnV0dG9ucygpO1xyXG5cclxuICAgICAgICBpZiAoYnV0dG9ucyA9PT0gJycgfHwgYnV0dG9ucyA9PT0gW10pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy4jZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZm9vdGVyJyk7XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgYnV0dG9ucyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGJ1dHRvbnM7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGJ1dHRvbnMpKSB7XHJcbiAgICAgICAgICAgIGJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGJ1dHRvbiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MICs9IGJ1dHRvbjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgI2J1aWxkQnV0dG9ucygpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgICAgICBsZXQgYnV0dG9ucyA9IHRoaXMuYnV0dG9ucztcclxuICAgICAgICBpZiAoYnV0dG9ucyA9PT0gW10pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChidXR0b25zID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXNlY29uZGFyeVwiIGRhdGEtYnMtZGlzbWlzcz1cIm1vZGFsXCI+Q2xvc2U8L2J1dHRvbj4nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiBidXR0b25zID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gYnV0dG9ucztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGJ1dHRvbnMpKSB7XHJcbiAgICAgICAgICAgIGJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBidXR0b25EYXRhID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGJ1dHRvbkRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgICAgICAgICAgIGlmIChidXR0b25EYXRhLmxhYmVsICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBidXR0b24uaW5uZXJIVE1MID0gYnV0dG9uRGF0YS5sYWJlbDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgYnV0dG9uRGF0YS5idG5UeXBlICE9PSB1bmRlZmluZWQgPyBidXR0b25EYXRhLmJ0blR5cGUgOiAnYnV0dG9uJyk7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnYnRuJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGJ1dHRvbkRhdGEudHlwZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2J0bi0nICsgYnV0dG9uRGF0YS50eXBlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoYnV0dG9uRGF0YS5jbG9zZU9uQ2xpY2sgIT09IHVuZGVmaW5lZCAmJiBidXR0b25EYXRhLmNsb3NlT25DbGljayA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtYnMtZGlzbWlzcycsICdtb2RhbCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChidXR0b25EYXRhLm9uQ2xpY2sgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgYnV0dG9uRGF0YS5vbkNsaWNrID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7cmV0dXJuIGJ1dHRvbkRhdGEub25DbGljayhldmVudCl9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChidXR0b24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxufSIsImltcG9ydCB7U2VydmVyRXZlbnRzfSBmcm9tICcuL3NlcnZlckV2ZW50cy9TZXJ2ZXJFdmVudHMuanMnO1xyXG5pbXBvcnQge1RvYXN0fSBmcm9tIFwiLi9Ub2FzdFwiO1xyXG5pbXBvcnQge01vZGFsfSBmcm9tIFwiLi9Nb2RhbFwiO1xyXG5cclxuLyoqXHJcbiAqIEJhc2UgQ290b250aSBjbGFzc1xyXG4gKi9cclxuY2xhc3MgQ290b250aUFwcGxpY2F0aW9uXHJcbntcclxuICAgICNzZXZlckV2ZW50cyA9IG51bGw7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgU2VydmVyIEV2ZW50cyBvYmplY3RcclxuICAgICAqIEByZXR1cm5zIHtTZXJ2ZXJFdmVudHN9XHJcbiAgICAgKi9cclxuICAgIGdldFNlcnZlckV2ZW50cygpIHtcclxuICAgICAgICBpZiAodGhpcy4jc2V2ZXJFdmVudHMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy4jc2V2ZXJFdmVudHMgPSBuZXcgU2VydmVyRXZlbnRzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLiNzZXZlckV2ZW50cztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNob3cgQ29uZmlybSBkaWFsb2cgbW9kYWxcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0aXRsZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbnRlbnRcclxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2tMYWJlbFxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNhbmNlbExhYmVsXHJcbiAgICAgKiBAdG9kbyB0cmFuc2xhdGVkIGRlZmF1bHQgbGFiZWxzXHJcbiAgICAgKi9cclxuICAgIGNvbmZpcm0odGl0bGUsIGNvbnRlbnQsIGNhbGxiYWNrLCBva0xhYmVsID0gJ09rJywgY2FuY2VsTGFiZWwgPSAnQ2FuY2VsJykge1xyXG4gICAgICAgIHRoaXMubW9kYWwodGl0bGUsIGNvbnRlbnQsIFtcclxuICAgICAgICAgICAge2xhYmVsOiBva0xhYmVsLCBvbkNsaWNrOiAoZXZlbnQpID0+IHtyZXR1cm4gY2FsbGJhY2soZXZlbnQpfSwgdHlwZTogJ3ByaW1hcnknLCBjbG9zZU9uQ2xpY2s6IHRydWV9LFxyXG4gICAgICAgICAgICB7bGFiZWw6IGNhbmNlbExhYmVsLCBjbG9zZU9uQ2xpY2s6IHRydWUsIHR5cGU6ICdzZWNvbmRhcnknfVxyXG4gICAgICAgIF0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBNb2RhbCBpbnN0YW5jZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbnRlbnRcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0aXRsZVxyXG4gICAgICogQHBhcmFtIHsoe1xyXG4gICAgICogICAgbGFiZWw6IFN0cmluZyxcclxuICAgICAqICAgIG9uQ2xpY2s6IGZ1bmN0aW9ufHVuZGVmaW5lZCxcclxuICAgICAqICAgIGNsb3NlT25DbGljazogYm9vbHx1bmRlZmluZWQsXHJcbiAgICAgKiAgICB0eXBlOiBzdHJpbmd8dW5kZWZpbmVkLFxyXG4gICAgICogICAgYnRuVHlwZTogc3RyaW5nfHVuZGVmaW5lZFxyXG4gICAgICogIH18c3RyaW5nKVtdfG51bGx9IGJ1dHRvbnNcclxuICAgICAqICBAcmV0dXJucyBNb2RhbFxyXG4gICAgICovXHJcbiAgICBnZXRNb2RhbChjb250ZW50LCB0aXRsZSA9ICcnLCBidXR0b25zPSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNb2RhbChjb250ZW50LCB0aXRsZSwgYnV0dG9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTaG93IE1vZGFsIHByb2dyYW1tYXRpY2FsbHlcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb250ZW50XHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdGl0bGVcclxuICAgICAqIEBwYXJhbSB7KHtcclxuICAgICAqICAgIGxhYmVsOiBTdHJpbmcsXHJcbiAgICAgKiAgICBvbkNsaWNrOiBmdW5jdGlvbnx1bmRlZmluZWQsXHJcbiAgICAgKiAgICBjbG9zZU9uQ2xpY2s6IGJvb2x8dW5kZWZpbmVkLFxyXG4gICAgICogICAgdHlwZTogc3RyaW5nfHVuZGVmaW5lZCxcclxuICAgICAqICAgIGJ0blR5cGU6IHN0cmluZ3x1bmRlZmluZWRcclxuICAgICAqICB9fHN0cmluZylbXXxudWxsfSBidXR0b25zXHJcbiAgICAgKiAgQHJldHVybnMgTW9kYWxcclxuICAgICAqL1xyXG4gICAgbW9kYWwoY29udGVudCwgdGl0bGUgPSAnJywgYnV0dG9ucz0gbnVsbCkge1xyXG4gICAgICAgIGNvbnN0IG1vZGFsID0gdGhpcy5nZXRNb2RhbChjb250ZW50LCB0aXRsZSwgYnV0dG9ucyk7XHJcbiAgICAgICAgbW9kYWwuc2hvdygpO1xyXG4gICAgICAgIHJldHVybiBtb2RhbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNob3cgVG9hc3RzIHByb2dyYW1tYXRpY2FsbHlcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdGl0bGVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBoaW50XHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZVxyXG4gICAgICogQHJldHVybnMgVG9hc3RcclxuICAgICAqL1xyXG4gICAgZ2V0VG9hc3QobWVzc2FnZSwgdGl0bGUgPSAnJywgaGludCA9ICcnLCB0eXBlID0gJycpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFRvYXN0KG1lc3NhZ2UsIHRpdGxlLCBoaW50LCB0eXBlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNob3cgVG9hc3RzIHByb2dyYW1tYXRpY2FsbHlcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdGl0bGVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBoaW50XHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZVxyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGRlbGF5XHJcbiAgICAgKi9cclxuICAgIHRvYXN0KG1lc3NhZ2UsIHRpdGxlID0gJycsIGhpbnQgPSAnJywgdHlwZSA9ICcnLCBkZWxheSA9IDUwMDApIHtcclxuICAgICAgICBjb25zdCB0b2FzdCA9IHRoaXMuZ2V0VG9hc3QobWVzc2FnZSwgdGl0bGUsIGhpbnQsIHR5cGUpO1xyXG5cclxuICAgICAgICBpZiAoZGVsYXkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdG9hc3QuZGVsYXkgPSBkZWxheVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdG9hc3Quc2hvdygpO1xyXG4gICAgICAgIHJldHVybiB0b2FzdDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBMb2FkIGRhdGEgZnJvbSAvaW5kZXgucGhwP249bWFpbiZhPWdldFxyXG4gICAgICogQ2FuIGJlIHVzZWZ1bCwgZm9yIGV4YW1wbGUgd2hlbiBpdCBpcyBuZWVkZWQgdG8gbG9hZCBzb21lIGR5bmFtaWMgY29udGVudCB0byBjYWNoZWQgcGFnZVxyXG4gICAgICpcclxuICAgICAqIEV4YW1wbGU6XHJcbiAgICAgKiBjb3QubG9hZERhdGEoWydjYXB0Y2hhJywgJ3gnXSkudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICogICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAqIH0pO1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB3aGF0IEFycmF5IG9yIHN0cmluZy4gRGF0YSB0byBsb2FkLiBGb3IgZXhhbXBsZSwgWydjYXB0Y2hhJywgJ3gnXSAoeCAtIGFudGkgWFNTIHBhcmFtZXRlciB2YWx1ZSlcclxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHt9Pn1cclxuICAgICAqL1xyXG4gICAgYXN5bmMgbG9hZERhdGEod2hhdCkge1xyXG4gICAgICAgIGlmICghd2hhdCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5sb2FkZWREYXRhID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2FkZWREYXRhID0ge307XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZGF0YVRvTG9hZCA9IFtdO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHdoYXQgPT09ICdzdHJpbmcnIHx8IHdoYXQgaW5zdGFuY2VvZiBTdHJpbmcpIHtcclxuICAgICAgICAgICAgd2hhdCA9IFt3aGF0XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGl0ZW0gb2Ygd2hhdCkge1xyXG4gICAgICAgICAgICBpZiAoIShpdGVtIGluIHRoaXMubG9hZGVkRGF0YSkpIHtcclxuICAgICAgICAgICAgICAgIGRhdGFUb0xvYWQucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGRhdGFUb0xvYWQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyBAdG9kbyBjaGFuZ2UgdG8gc3lzdGVtIGNvbnRyb2xsZXIgd2hlbiBpdCB3aWxsIGJlIGltcGxlbWVudGVkXHJcbiAgICAgICAgICAgIGxldCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHtuOiAnbWFpbicsIGE6ICdnZXQnfSk7XHJcblxyXG4gICAgICAgICAgICBkYXRhVG9Mb2FkLmZvckVhY2goKGl0ZW0sIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLmFwcGVuZCgnZGF0YVsnICsgaW5kZXggKyAnXScsIGl0ZW0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcGFyYW1zLmFwcGVuZCgnX2FqYXgnLCAxKTtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdpbmRleC5waHA/JyArIHBhcmFtcy50b1N0cmluZygpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlRGF0YS5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHJlc3BvbnNlRGF0YS5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRlZERhdGFba2V5XSA9IHJlc3BvbnNlRGF0YS5kYXRhW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBIVFRQIGVycm9yXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZXF1ZXN0IGVycm9yXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcclxuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIHdoYXQpIHtcclxuICAgICAgICAgICAgaWYgKChpdGVtIGluIHRoaXMubG9hZGVkRGF0YSkpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtpdGVtXSA9IHRoaXMubG9hZGVkRGF0YVtpdGVtXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvYWQgY2FwdGNoYSB2aWEgYWpheC4gVXNlZCBvbiBjYWNoZWQgcGFnZXMuXHJcbiAgICAgKi9cclxuICAgIGxvYWRDYXB0Y2hhKCkge1xyXG4gICAgICAgIHRoaXMubG9hZERhdGEoWydjYXB0Y2hhJywgJ3gnXSkudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2FwdGNoYUVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNhcHRjaGEtcGxhY2UtaG9sZGVyJyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGVsZW1lbnQgb2YgY2FwdGNoYUVsZW1lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IHJlc3VsdC5jYXB0Y2hhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlU2NyaXB0RWxlbWVudHMoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NhcHRjaGEtcGxhY2UtaG9sZGVyJywgJ2xvYWRpbmcnKTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2FwdGNoYScpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm0gPSBlbGVtZW50LmNsb3Nlc3QoJ2Zvcm0nKTtcclxuICAgICAgICAgICAgICAgIGlmIChmb3JtICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlucHV0WCA9IGZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cImhpZGRlblwiXVtuYW1lPVwieFwiXScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dFggIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRYLnNldEF0dHJpYnV0ZSgndmFsdWUnLCByZXN1bHQueCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJZiB5b3UgYXBwZW5kIDxzY3JpcHQ+IHRhZ3MgdG8gdGhlIGVsZW1lbnRzIG9mIHRoZSBmaW5pc2hlZCBET00gZG9jdW1lbnQsIHRoZXkgd2lsbCBub3QgYmUgZXhlY3V0ZWQgYXV0b21hdGljYWxseS5cclxuICAgICAqIFRoZSBtZXRob2QgZXhlY3V0ZXMgPHNjcmlwdD4gc2NyaXB0cyBuZXN0ZWQgaW4gdGhlIHNwZWNpZmllZCBlbGVtZW50XHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyRWxlbWVudCBOb2RlXHJcbiAgICAgKi9cclxuICAgIGV4ZWN1dGVTY3JpcHRFbGVtZW50cyhjb250YWluZXJFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3Qgc2NyaXB0RWxlbWVudHMgPSBjb250YWluZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NjcmlwdCcpO1xyXG5cclxuICAgICAgICBBcnJheS5mcm9tKHNjcmlwdEVsZW1lbnRzKS5mb3JFYWNoKChzY3JpcHRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsb25lZEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcclxuICAgICAgICAgICAgQXJyYXkuZnJvbShzY3JpcHRFbGVtZW50LmF0dHJpYnV0ZXMpLmZvckVhY2goKGF0dHJpYnV0ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2xvbmVkRWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLm5hbWUsIGF0dHJpYnV0ZS52YWx1ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjbG9uZWRFbGVtZW50LnRleHQgPSBzY3JpcHRFbGVtZW50LnRleHQ7XHJcbiAgICAgICAgICAgIHNjcmlwdEVsZW1lbnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoY2xvbmVkRWxlbWVudCwgc2NyaXB0RWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbndpbmRvdy5jb3QgPSBuZXcgQ290b250aUFwcGxpY2F0aW9uKCk7XHJcbiIsImZ1bmN0aW9uIGVuY29kZVVSSWZpeChzdHIpIHtcclxuXHQvLyB0byBwcmV2ZW50IHR3aWNlIGVuY29kaW5nXHJcblx0Ly8gYW5kIGZpeCAnWycsJ10nIHNpZ25zIHRvIGZvbGxvdyBSRkMzOTg2IChzZWN0aW9uLTMuMi4yKVxyXG5cdHJldHVybiBlbmNvZGVVUkkoZGVjb2RlVVJJKHN0cikpLnJlcGxhY2UoLyU1Qi9nLCAnWycpLnJlcGxhY2UoLyU1RC9nLCAnXScpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRCYXNlSHJlZigpIHtcclxuXHR2YXIgaHJlZiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdiYXNlJylbMF0uaHJlZjtcclxuXHRpZiAoaHJlZiA9PSBudWxsKSB7XHJcblx0XHRyZXR1cm4gJy8nO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRyZXR1cm4gaHJlZjtcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBvcHVwKGNvZGUsIHcsIGgpe1xyXG4gICAgd2luZG93Lm9wZW4oZ2V0QmFzZUhyZWYoKSArICdpbmRleC5waHA/bz0nICsgY29kZSwgJycsICd0b29sYmFyPTAsbG9jYXRpb249MCxkaXJlY3Rvcmllcz0wLG1lbnVCYXI9MCxyZXNpemFibGU9MCxzY3JvbGxiYXJzPXllcyx3aWR0aD0nICsgdyArICcsaGVpZ2h0PScgKyBoICsgJyxsZWZ0PTMyLHRvcD0xNicpO1xyXG59XHJcblxyXG4vKipcclxuICogQHRvZG8gbW92ZSB0byBwZnMgbW9kdWxlXHJcbiAqL1xyXG5mdW5jdGlvbiBwZnMoaWQsIGMxLCBjMiwgcGFyc2VyKXtcclxuICAgIHdpbmRvdy5vcGVuKFxyXG5cdFx0Z2V0QmFzZUhyZWYoKSArICdpbmRleC5waHA/ZT1wZnMmdXNlcmlkPScgKyBpZCArICcmYzE9JyArIGMxICsgJyZjMj0nICsgYzIgKyAnJnBhcnNlcj0nICsgcGFyc2VyLFxyXG5cdFx0J1BGUycsXHJcblx0XHQnc3RhdHVzPTEsIHRvb2xiYXI9MCxsb2NhdGlvbj0wLGRpcmVjdG9yaWVzPTAsbWVudUJhcj0wLHJlc2l6YWJsZT0xLHNjcm9sbGJhcnM9eWVzLHdpZHRoPTc1NCxoZWlnaHQ9NTEyLGxlZnQ9MzIsdG9wPTE2J1xyXG5cdCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlZGlyZWN0KHVybCl7XHJcbiAgICBsb2NhdGlvbi5ocmVmID0gdXJsLm9wdGlvbnNbdXJsLnNlbGVjdGVkSW5kZXhdLnZhbHVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0b2dnbGVibG9jayhpZCl7XHJcbiAgICB2YXIgYmwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICBpZiAoYmwuc3R5bGUuZGlzcGxheSA9PSAnbm9uZScpIHtcclxuICAgICAgICBibC5zdHlsZS5kaXNwbGF5ID0gJyc7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBibC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgfVxyXG5cdHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9nZ2xlQWxsKGFjdGlvbikge1xyXG5cdHZhciBibGtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2lkXj1cImJsa19cIl0nKTtcclxuXHRmb3IgKGkgPSAwOyBpIDwgYmxrcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0aWYgKGFjdGlvbiA9PSAnaGlkZScpIHtcclxuXHRcdFx0Ymxrc1tpXS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG5cdFx0fSBlbHNlIGlmIChhY3Rpb24gPT0gJ3Nob3cnKSB7XHJcblx0XHRcdGJsa3NbaV0uc3R5bGUuZGlzcGxheSA9ICd0YWJsZS1yb3ctZ3JvdXAnO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbi8vIEluc2VydHMgdGV4dCBpbnRvIHRleHRhcmVhIGF0IGN1cnNvciBwb3NpdGlvblxyXG5mdW5jdGlvbiBpbnNlcnRUZXh0KGRvY09iaiwgZmllbGROYW1lLCB2YWx1ZSkge1xyXG5cdHZhciBmaWVsZCA9IG51bGw7XHJcblx0aWYgKCFkb2NPYmopIHtcclxuXHRcdGRvY09iaiA9IGRvY3VtZW50O1xyXG5cdH1cclxuXHQvLyBGaW5kIHRoZSBmaWVsZCBpbiB0aGUgZG9jT2JqXHJcblx0ZmluZEZpZWxkOlxyXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgZG9jT2JqLmZvcm1zLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGRvY09iai5mb3Jtc1tpXS5lbGVtZW50cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRpZiAoZG9jT2JqLmZvcm1zW2ldLmVsZW1lbnRzW2pdLm5hbWUgPT0gZmllbGROYW1lKSB7XHJcblx0XHRcdFx0ZmllbGQgPSBkb2NPYmouZm9ybXNbaV0uZWxlbWVudHNbal07XHJcblx0XHRcdFx0YnJlYWsgZmluZEZpZWxkO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdGlmICghZmllbGQpIHtcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblxyXG5cdC8vIEluc2VydCB0aGUgdGV4dFxyXG5cdGlmIChkb2NPYmouc2VsZWN0aW9uKSB7XHJcblx0XHQvLyBNU0lFIGFuZCBPcGVyYVxyXG5cdFx0ZmllbGQuZm9jdXMoKTtcclxuXHRcdHZhciBzZWwgPSBkb2NPYmouc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XHJcblx0XHRzZWwudGV4dCA9IHZhbHVlO1xyXG5cdH0gZWxzZSBpZiAoZmllbGQuc2VsZWN0aW9uU3RhcnQgfHwgZmllbGQuc2VsZWN0aW9uU3RhcnQgPT0gMCkge1xyXG5cdFx0Ly8gTW96aWxsYVxyXG5cdFx0dmFyIHN0YXJ0UG9zID0gZmllbGQuc2VsZWN0aW9uU3RhcnQ7XHJcblx0XHR2YXIgZW5kUG9zID0gZmllbGQuc2VsZWN0aW9uRW5kO1xyXG5cdFx0ZmllbGQudmFsdWUgPSBmaWVsZC52YWx1ZS5zdWJzdHJpbmcoMCwgc3RhcnRQb3MpICsgdmFsdWUgKyBmaWVsZC52YWx1ZS5zdWJzdHJpbmcoZW5kUG9zLCBmaWVsZC52YWx1ZS5sZW5ndGgpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRmaWVsZC52YWx1ZSArPSB2YWx1ZTtcclxuXHR9XHJcblx0cmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8vIEFycmF5IG9mIGFqYXggZXJyb3IgaGFuZGxlcnNcclxuLy8gRXhhbXBsZSBvZiB1c2U6XHJcbi8vIGFqYXhFcnJvckhhbmRsZXJzLnB1c2goe2Z1bmM6IG15RXJyb3JIYW5kbGVyfSk7XHJcbi8vIGFqYXhTdWNjZXNzSGFuZGxlcnMucHVzaCh7ZnVuYzogbXlTdWNjZXNzSGFuZGxlcn0pO1xyXG52YXIgYWpheEVycm9ySGFuZGxlcnMgPSBuZXcgQXJyYXkoKTtcclxudmFyIGFqYXhTdWNjZXNzSGFuZGxlcnMgPSBuZXcgQXJyYXkoKTtcclxuLy8gQUpBWCBlbmFibGVtZW50IGRlZmF1bHRzIHRvIGZhbHNlXHJcbnZhciBhamF4RW5hYmxlZCA9IGZhbHNlO1xyXG4vLyBSZXF1aXJlZCB0byBjYWxjdWxhdGUgcGF0aHNcclxuaWYgKHR5cGVvZiBqUXVlcnkgIT0gJ3VuZGVmaW5lZCcpIHtcclxuXHR2YXIgYWpheEN1cnJlbnRCYXNlID0gbG9jYXRpb24uaHJlZi5yZXBsYWNlKCQoJ2Jhc2UnKS5lcSgwKS5hdHRyKCdocmVmJyksICcnKS5yZXBsYWNlKC9cXD8uKiQvLCAnJykucmVwbGFjZSgvIy4qJC8sICcnKTtcclxufVxyXG4vLyBUaGlzIGZsYWcgaW5kaWNhdGVzIHRoYXQgQUpBWCtoaXN0b3J5IGhhcyBiZWVuIHVzZWQgb24gdGhpcyBwYWdlXHJcbi8vIEl0IG1lYW5zIHRoYXQgXCIjXCIgb3IgaG9tZSBsaW5rIHNob3VsZCBiZSBsb2FkZWQgdmlhIGFqYXggdG9vXHJcbnZhciBhamF4VXNlZCA9IGZhbHNlO1xyXG4vLyBHbG9iYWwgZmxhZyB0byBsZXQgZXZlcnlib2R5IGtub3cgdGhhdCBBSkFYIGhhcyBmYWlsZWRcclxudmFyIGFqYXhFcnJvciA9IGZhbHNlO1xyXG5cclxuLyoqXHJcbiAqIEFKQVggaGVscGVyIGZ1bmN0aW9uXHJcbiAqIEBwYXJhbSB7aGFzaH0gc2V0dGluZ3MgQSBoYXNodGFibGUgd2l0aCBzZXR0aW5nc1xyXG4gKiBAcmV0dXJuIEZBTFNFIG9uIHN1Y2Nlc3NmdWwgQUpBWCBjYWxsLCBUUlVFIG9uIGVycm9yIHRvIGNvbnRpbnVlIGluXHJcbiAqIHN5bmNocm9ub3VzIG1vZGVcclxuICogQHR5cGUgYm9vbFxyXG4gKi9cclxuZnVuY3Rpb24gYWpheFNlbmQoc2V0dGluZ3MpIHtcclxuXHR2YXIgbWV0aG9kID0gc2V0dGluZ3MubWV0aG9kID8gc2V0dGluZ3MubWV0aG9kLnRvVXBwZXJDYXNlKCkgOiAnR0VUJztcclxuXHR2YXIgZGF0YSA9IHNldHRpbmdzLmRhdGEgfHwgJyc7XHJcblx0dmFyIHVybCA9IHNldHRpbmdzLnVybCB8fCAkKCcjJyArIHNldHRpbmdzLmZvcm1JZCkuYXR0cignYWN0aW9uJyk7XHJcblx0aWYgKG1ldGhvZCA9PT0gJ1BPU1QnKSB7XHJcblx0XHRkYXRhICs9ICcmJyArICQoJyMnICsgc2V0dGluZ3MuZm9ybUlkKS5zZXJpYWxpemUoKTtcclxuXHR9IGVsc2UgaWYgKHNldHRpbmdzLmZvcm1JZCkge1xyXG5cdFx0dmFyIHNlcCA9IHVybC5pbmRleE9mKCc/JykgPiAwID8gJyYnIDogJz8nO1xyXG5cdFx0dXJsICs9IHNlcCArICQoJyMnICsgc2V0dGluZ3MuZm9ybUlkKS5zZXJpYWxpemUoKTtcclxuXHR9XHJcblx0JC5hamF4KHtcclxuXHRcdHR5cGU6IG1ldGhvZCxcclxuXHRcdHVybDogZW5jb2RlVVJJZml4KHVybCksXHJcblx0XHRkYXRhOiBkYXRhLFxyXG5cdFx0YmVmb3JlU2VuZDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICghc2V0dGluZ3Mubm9uc2hvd2xvYWRpbmcpIHtcclxuXHRcdFx0XHQkKCcjJyArIHNldHRpbmdzLmRpdklkKVxyXG5cdFx0XHRcdFx0LmFwcGVuZCgnPHNwYW4gc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTsgbGVmdDonICsgKCQoJyMnICsgc2V0dGluZ3MuZGl2SWQpLndpZHRoKCkvMiAtIDExMCkgKyAncHg7dG9wOicgKyAoJCgnIycgKyBzZXR0aW5ncy5kaXZJZCkuaGVpZ2h0KCkvMiAtIDkpICsgJ3B4O1wiIGNsYXNzPVwibG9hZGluZ1wiIGlkPVwibG9hZGluZ1wiPjxpbWcgc3JjPVwiLi9pbWFnZXMvc3Bpbm5lci5naWZcIiBhbHQ9XCJsb2FkaW5nXCIvPjwvc3Bhbj4nKS5jc3MoJ3Bvc2l0aW9uJywgJ3JlbGF0aXZlJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihtc2cpIHtcclxuXHRcdFx0aWYgKCFzZXR0aW5ncy5ub25zaG93bG9hZGluZykge1xyXG5cdFx0XHRcdCQoJyNsb2FkaW5nJykucmVtb3ZlKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCFzZXR0aW5ncy5ub25zaG93ZmFkZWluKSB7XHJcblx0XHRcdFx0JCgnIycgKyBzZXR0aW5ncy5kaXZJZCkuaGlkZSgpLmh0bWwobXNnKS5mYWRlSW4oNTAwKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkKCcjJyArIHNldHRpbmdzLmRpdklkKS5odG1sKG1zZyk7XHJcblx0XHRcdH1cclxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhamF4U3VjY2Vzc0hhbmRsZXJzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0aWYoYWpheFN1Y2Nlc3NIYW5kbGVyc1tpXS5mdW5jKVxyXG5cdFx0XHRcdFx0YWpheFN1Y2Nlc3NIYW5kbGVyc1tpXS5mdW5jKG1zZyk7XHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0YWpheFN1Y2Nlc3NIYW5kbGVyc1tpXShtc2cpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKG1zZykge1xyXG5cdFx0XHRpZiAoIXNldHRpbmdzLm5vbnNob3dsb2FkaW5nKSB7XHJcblx0XHRcdFx0JCgnI2xvYWRpbmcnKS5yZW1vdmUoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIXNldHRpbmdzLm5vbnNob3dmYWRlaW4pIHtcclxuXHRcdFx0XHQkKCcjJyArIHNldHRpbmdzLmRpdklkKS5oaWRlKCkuaHRtbChtc2cpLmZhZGVJbig1MDApO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoJyMnICsgc2V0dGluZ3MuZGl2SWQpLmh0bWwobXNnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoYWpheEVycm9ySGFuZGxlcnMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYWpheEVycm9ySGFuZGxlcnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdGlmIChhamF4RXJyb3JIYW5kbGVyc1tpXS5mdW5jKSB7XHJcblx0XHRcdFx0XHRcdGFqYXhFcnJvckhhbmRsZXJzW2ldLmZ1bmMobXNnKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGFqYXhFcnJvckhhbmRsZXJzW2ldKG1zZyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGFsZXJ0KCdBSkFYIGVycm9yOiAnICsgbXNnKTtcclxuXHRcdFx0XHRhamF4RXJyb3IgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG4vKipcclxuICogQUpBWCBzdWJwYWdlIGxvYWRlciB3aXRoIGhpc3Rvcnkgc3VwcG9ydFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gaGFzaCBBIGhhc2gtYWRkcmVzcyBzdHJpbmdcclxuICogQHJldHVybiBGQUxTRSBvbiBzdWNjZXNzZnVsIEFKQVggY2FsbCwgVFJVRSBvbiBlcnJvciB0byBjb250aW51ZSBpblxyXG4gKiBzeW5jaHJvbm91cyBtb2RlXHJcbiAqIEB0eXBlIGJvb2xcclxuICovXHJcbmZ1bmN0aW9uIGFqYXhQYWdlTG9hZChoYXNoKSB7XHJcbiAgICBpZiAoaGFzaCAhPT0gJycpIHtcclxuXHRcdGhhc2gucmVwbGFjZSgvXiMvLCAnJyk7XHJcblx0fVxyXG5cdHZhciBtID0gaGFzaC5tYXRjaCgvXmdldCgtLio/KT87KC4qKSQvKTtcclxuXHRpZiAobSkge1xyXG5cdFx0Ly8gYWpheCBib29rbWFya1xyXG4gICAgICAgIHZhciB1cmwgPSBtWzJdLmluZGV4T2YoJzsnKSA+IDAgPyBtWzJdLnJlcGxhY2UoJzsnLCAnPycpIDogYWpheEN1cnJlbnRCYXNlICsgJz8nICsgZGVjb2RlVVJJQ29tcG9uZW50KG1bMl0pO1xyXG5cdFx0YWpheFVzZWQgPSB0cnVlO1xyXG5cdFx0cmV0dXJuIGFqYXhTZW5kKHtcclxuXHRcdFx0bWV0aG9kOiAnR0VUJyxcclxuXHRcdFx0dXJsOiB1cmwsXHJcblx0XHRcdGRpdklkOiBtWzFdID8gbVsxXS5zdWJzdHIoMSkgOiAnYWpheEJsb2NrJ1xyXG5cdFx0fSk7XHJcblx0fSBlbHNlIGlmIChoYXNoID09PSAnJyAmJiBhamF4VXNlZCkge1xyXG5cdFx0Ly8gYWpheCBob21lXHJcblx0XHRyZXR1cm4gYWpheFNlbmQgKHtcclxuXHRcdFx0dXJsOiBsb2NhdGlvbi5ocmVmLnJlcGxhY2UoLyMuKiQvLCAnJyksXHJcblx0XHRcdGRpdklkOiAnYWpheEJsb2NrJ1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cdHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICogQUpBWCBzdWJmb3JtIGxvYWRlciB3aXRob3V0IGhpc3RvcnkgdHJhY2tpbmdcclxuICogQHBhcmFtIHtzdHJpbmd9IGhhc2ggQSBoYXNoLWFkZHJlc3Mgc3RyaW5nXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBmb3JtSWQgVGFyZ2V0IGZvcm0gaWQgYXR0cmlidXRlXHJcbiAqIEByZXR1cm4gRkFMU0Ugb24gc3VjY2Vzc2Z1bCBBSkFYIGNhbGwsIFRSVUUgb24gZXJyb3IgdG8gY29udGludWUgaW5cclxuICogc3luY2hyb25vdXMgbW9kZVxyXG4gKiBAdHlwZSBib29sXHJcbiAqL1xyXG5mdW5jdGlvbiBhamF4Rm9ybUxvYWQoaGFzaCwgZm9ybUlkKSB7XHJcblx0dmFyIG0gPSBoYXNoLm1hdGNoKC9eKGdldHxwb3N0KSgtLio/KT87KC4qKSQvKTtcclxuXHRpZiAobSkge1xyXG5cdFx0Ly8gYWpheCBib29rbWFya1xyXG5cdFx0dmFyIHVybCA9IG1bM10uaW5kZXhPZignOycpID4gMCA/IG1bM10ucmVwbGFjZSgnOycsICc/JykgOiBhamF4Q3VycmVudEJhc2UgKyAnPycgKyBtWzNdO1xyXG5cdFx0YWpheFVzZWQgPSB0cnVlO1xyXG5cdFx0cmV0dXJuIGFqYXhTZW5kKHtcclxuXHRcdFx0bWV0aG9kOiBtWzFdLnRvVXBwZXJDYXNlKCksXHJcblx0XHRcdHVybDogdXJsLFxyXG5cdFx0XHRkaXZJZDogbVsyXSA/IG1bMl0uc3Vic3RyKDEpIDogJ2FqYXhCbG9jaycsXHJcblx0XHRcdGZvcm1JZDogZm9ybUlkXHJcblx0XHR9KTtcclxuXHR9XHJcblx0cmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb25zdHJ1Y3RzIGFqYXhhYmxlIGhhc2ggc3RyaW5nXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBocmVmIExpbmsgaHJlZiBvciBmb3JtIGFjdGlvbiBhdHRyaWJ1dGVcclxuICogQHBhcmFtIHtzdHJpbmd9IHJlbCBBbiBhdHRyaWJ1dGUgdmFsdWUgcG9zc2libHkgY29udGFpbmluZyBhIGhhc2ggYWRkcmVzc1xyXG4gKiBAcGFyYW0ge3N0cmluZ30gZm9ybURhdGEgSXMgcGFzc2VkIGZvciBmb3JtcyBvbmx5LCBpcyAncG9zdCcgZm9yIFBPU1QgZm9ybXNcclxuICogb3Igc2VyaWFsaXplZCBmb3JtIGRhdGEgZm9yIEdFVCBmb3Jtc1xyXG4gKiBAcmV0dXJuIEEgdmFsaWQgaGFzaC1hZGRyZXNzIHN0cmluZ1xyXG4gKiBAdHlwZSBzdHJpbmdcclxuICovXHJcbmZ1bmN0aW9uIGFqYXhNYWtlSGFzaChocmVmLCByZWwsIGZvcm1EYXRhKSB7XHJcblx0dmFyIGhhc2ggPSAoZm9ybURhdGEgPT0gJ3Bvc3QnKSA/ICdwb3N0JyA6ICdnZXQnO1xyXG5cdHZhciBocmVmQmFzZSwgcGFyYW1zO1xyXG5cdHZhciBzZXAgPSAnPyc7XHJcblx0dmFyIG0gPSByZWwgPyByZWwubWF0Y2goLyhnZXR8cG9zdCkoLVteIDtdKyk/KDtcXFMqKT8vKSA6IGZhbHNlO1xyXG5cdGlmIChtKSB7XHJcblx0XHRoYXNoID0gbVsxXTtcclxuXHRcdGlmIChtWzJdKSB7XHJcblx0XHRcdGhhc2ggKz0gbVsyXTtcclxuXHRcdH1cclxuXHRcdGlmIChtWzNdKSB7XHJcblx0XHRcdGhyZWYgPSBtWzNdLnN1YnN0cigxKTtcclxuXHRcdFx0c2VwICA9ICc7JztcclxuXHRcdH1cclxuXHR9XHJcblx0aGFzaCArPSAnOydcclxuXHRpZiAoaHJlZi5pbmRleE9mKHNlcCkgPiAwKSB7XHJcblx0XHRocmVmQmFzZSA9IGhyZWYuc3Vic3RyKDAsIGhyZWYuaW5kZXhPZihzZXApKTtcclxuXHRcdHBhcmFtcyA9IGhyZWYuc3Vic3RyKGhyZWYuaW5kZXhPZihzZXApICsgMSk7XHJcblx0XHRpZiAoZm9ybURhdGEgJiYgZm9ybURhdGEgIT0gJ3Bvc3QnKSB7XHJcblx0XHRcdHBhcmFtcyArPSAnJicgKyBmb3JtRGF0YTtcclxuXHRcdH1cclxuXHR9IGVsc2Uge1xyXG5cdFx0aHJlZkJhc2UgPSBocmVmO1xyXG5cdFx0cGFyYW1zID0gJyc7XHJcblx0XHRpZiAoZm9ybURhdGEgJiYgZm9ybURhdGEgIT0gJ3Bvc3QnKSB7XHJcblx0XHRcdHBhcmFtcyArPSBzZXAgKyBmb3JtRGF0YTtcclxuXHRcdH1cclxuXHR9XHJcblx0aGFzaCArPSBocmVmQmFzZSA9PSBhamF4Q3VycmVudEJhc2UgPyBwYXJhbXMgOiBocmVmQmFzZSArICc7JyArIHBhcmFtcztcclxuXHRyZXR1cm4gaGFzaDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFN0YW5kYXJkIGV2ZW50IGJpbmRpbmdzXHJcbiAqL1xyXG5mdW5jdGlvbiBiaW5kSGFuZGxlcnMoKSB7XHJcblx0aWYgKGxvY2F0aW9uLmhhc2ggPT0gJyNjb21tZW50cycgfHwgbG9jYXRpb24uaGFzaC5tYXRjaCgvI2NcXGQrLykpIHtcclxuXHRcdCQoJy5jb21tZW50cycpLmNzcygnZGlzcGxheScsICcnKTtcclxuXHR9XHJcblx0JCgnLmNvbW1lbnRzX2xpbmsnKS5jbGljayhmdW5jdGlvbigpIHtcclxuXHRcdGlmKCQoJy5jb21tZW50cycpLmNzcygnZGlzcGxheScpID09ICdub25lJykge1xyXG5cdFx0XHQkKCcuY29tbWVudHMnKS5jc3MoJ2Rpc3BsYXknLCAnJyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQkKCcuY29tbWVudHMnKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRpZihsb2NhdGlvbi5ocmVmLm1hdGNoKC8jY29tbWVudHMvKSkge1xyXG5cdFx0JCgnLmNvbW1lbnRzJykuY3NzKCdkaXNwbGF5JywgJycpO1xyXG5cdH1cclxuXHJcblx0aWYgKGFqYXhFbmFibGVkKSB7XHJcblx0XHQvLyBBSkFYIGF1dG8taGFuZGxpbmdcclxuXHRcdCQoJ2JvZHknKS5vbignc3VibWl0JywgJ2Zvcm0uYWpheCcsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZiAoJCh0aGlzKS5hdHRyKCdtZXRob2QnKS50b1VwcGVyQ2FzZSgpID09ICdQT1NUJykge1xyXG5cdFx0XHRcdGFqYXhGb3JtTG9hZChhamF4TWFrZUhhc2goJCh0aGlzKS5hdHRyKCdhY3Rpb24nKS5yZXBsYWNlKC8jLiokLywgJycpLCAkKHRoaXMpLmF0dHIoJ2NsYXNzJyksICdwb3N0JyksICQodGhpcykuYXR0cignaWQnKSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhhc2ggPSBhamF4TWFrZUhhc2goJCh0aGlzKS5hdHRyKCdhY3Rpb24nKS5yZXBsYWNlKC8jLiokLywgJycpLCAkKHRoaXMpLmF0dHIoJ2NsYXNzJyksICQodGhpcykuc2VyaWFsaXplKCkpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBhamF4RXJyb3I7XHJcblx0XHR9KTtcclxuXHRcdCQoJ2JvZHknKS5vbignY2xpY2snLCAnYS5hamF4JywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gYWpheE1ha2VIYXNoKCQodGhpcykuYXR0cignaHJlZicpLnJlcGxhY2UoLyMuKiQvLCAnJyksICQodGhpcykuYXR0cigncmVsJykpO1xyXG5cdFx0XHRyZXR1cm4gYWpheEVycm9yO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gQUpBWCBhY3Rpb24gY29uZmlybWF0aW9uc1xyXG5cdFx0JCgnYm9keScpLm9uKCdjbGljaycsICdhLmNvbmZpcm1MaW5rJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICgkKHRoaXMpLmF0dHIoJ2hyZWYnKS5tYXRjaCgvbWVzc2FnZS4rOTIwL2kpKSB7XHJcblx0XHRcdFx0aWYgKCQoJyNjb25maXJtQm94JykpIHtcclxuXHRcdFx0XHRcdCQoJyNjb25maXJtQm94JykucmVtb3ZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCQoJ2JvZHknKS5wcmVwZW5kKCc8ZGl2IGlkPVwiY29uZmlybUJveFwiIGNsYXNzPVwianFtV2luZG93XCI+PC9kaXY+Jyk7XHJcblx0XHRcdFx0JCgnI2NvbmZpcm1Cb3gnKS5qcW0oe2FqYXg6JCh0aGlzKS5hdHRyKCdocmVmJyksbW9kYWw6dHJ1ZSxvbkxvYWQ6ZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdCQoJyNjb25maXJtQm94JykuY3NzKCdtYXJnaW4tbGVmdCcsICctJysoJCgnI2NvbmZpcm1Cb3gnKS53aWR0aCgpLzIpKydweCcpO1xyXG5cdFx0XHRcdFx0JCgnI2NvbmZpcm1Cb3gnKS5jc3MoJ21hcmdpbi10b3AnLCAnLScrKCQoJyNjb25maXJtQm94JykuaGVpZ2h0KCkvMikrJ3B4Jyk7XHJcblx0XHRcdFx0fX0pO1xyXG5cdFx0XHRcdCQoJyNjb25maXJtQm94JykuanFtU2hvdygpO1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gTGlzdGVuIHRvIGhhc2ggY2hhbmdlIGV2ZW50c1xyXG5cdFx0JCh3aW5kb3cpLm9uKCdoYXNoY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGFqYXhQYWdlTG9hZCh3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKC9eIy8sICcnKSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQkKCdib2R5Jykub24oJ2NsaWNrJywgJ2EjY29uZmlybU5vJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICgkKFwiI2NvbmZpcm1Cb3hcIikuaXMoXCIuanFtV2luZG93XCIpKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0JCgnI2NvbmZpcm1Cb3gnKS5qcW1IaWRlKCk7XHJcblx0XHRcdFx0JCgnI2NvbmZpcm1Cb3gnKS5yZW1vdmUoKTtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuaWYgKHR5cGVvZiBqUXVlcnkgIT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vIElmIHBhZ2Ugd2FzIGxvYWRlZCB3aXRoIGhhc2hcclxuICAgICAgICBpZiAoYWpheEVuYWJsZWQpIHtcclxuICAgICAgICAgICAgaWYod2luZG93LmxvY2F0aW9uLmhhc2ggIT0gJycpIHtcclxuICAgICAgICAgICAgICAgIGFqYXhQYWdlTG9hZCh3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKC9eIy8sICcnKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGJpbmRIYW5kbGVycygpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbndpbmRvdy5uYW1lID0gJ21haW4nOyJdfQ==
