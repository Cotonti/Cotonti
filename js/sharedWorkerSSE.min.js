(()=>{"use strict";class e{eventsUrl=null;#e=null;onEvent=null;constructor(e,n=null){this.eventsUrl=e,null!==n&&(this.mode=n),this.init()}init(){null===this.#e&&("production"!==this.mode&&console.log("init ServerSentEventsClient"),this.#e=new EventSource(this.eventsUrl),"production"!==this.mode&&(this.#e.onopen=function(e){console.log("ServerSentEventsClient connection is open")}),this.#e.onmessage=e=>{const n=JSON.parse(e.data);void 0!==n.data&&"string"==typeof n.data&&""!==n.data&&(n.data=JSON.parse(n.data)),n.eventId=e.lastEventId,this.#n(n)},"production"!==this.mode&&(this.#e.onerror=function(e){console.log("ServerSentEventsClient connection error")}))}#n(e){"production"!==this.mode&&console.log("ServerSentEventsClient: Server triggered event",e),"function"!=typeof this.onEvent&&console.error(this.constructor.name+".onEvent is not defined"),this.onEvent(e)}}class n{#t=null;mode="production";eventsUrl=null;onEvent=null;init(){null===this.#t&&("production"!==this.mode&&console.log("init Shared worker SSE"),this.#t=new e(this.eventsUrl,this.mode),this.#t.onEvent=e=>{"function"!=typeof this.onEvent&&console.error(this.constructor.name+".onEvent is not defined"),this.onEvent(e)})}}const t=[];let o=null;self.onconnect=e=>{const s=e.ports[0];t.push(s),null===o&&(o=new n,o.onEvent=e=>{"production"!==o.mode&&console.log("Shared worker postMessage",e);for(const n of t)n.postMessage(e)}),s.onmessage=e=>{const n=e.data;void 0!==n.config&&(o.eventsUrl=n.config.url,o.mode=n.config.mode,o.init()),"production"!==o.mode&&console.log("Shared worker message",n)}}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBSU8sTUFBTUEsRUFJVEMsVUFBWSxLQUtaLEdBQWUsS0FLZkMsUUFBVSxLQUVWLFdBQUFDLENBQVlGLEVBQVdHLEVBQU8sTUFDMUJDLEtBQUtKLFVBQVlBLEVBQ0osT0FBVEcsSUFDQUMsS0FBS0QsS0FBT0EsR0FFaEJDLEtBQUtDLE1BQ1QsQ0FFQSxJQUFBQSxHQUM4QixPQUF0QkQsTUFBSyxJQUlTLGVBQWRBLEtBQUtELE1BQ0xHLFFBQVFDLElBQUksK0JBR2hCSCxNQUFLLEVBQWUsSUFBSUksWUFBWUosS0FBS0osV0FFdkIsZUFBZEksS0FBS0QsT0FDTEMsTUFBSyxFQUFhSyxPQUFTLFNBQVVDLEdBQ2pDSixRQUFRQyxJQUFJLDRDQUNoQixHQUdKSCxNQUFLLEVBQWFPLFVBQWFELElBQzNCLE1BQU1FLEVBQVlDLEtBQUtDLE1BQU1KLEVBQU1LLFdBQ1pDLElBQW5CSixFQUFVRyxNQUFpRCxpQkFBbkJILEVBQVVHLE1BQXlDLEtBQW5CSCxFQUFVRyxPQUNsRkgsRUFBVUcsS0FBT0YsS0FBS0MsTUFBTUYsRUFBVUcsT0FFMUNILEVBQVVLLFFBQVVQLEVBQU1RLFlBQzFCZCxNQUFLLEVBQWtCUSxFQUFVLEVBR25CLGVBQWRSLEtBQUtELE9BQ0xDLE1BQUssRUFBYWUsUUFBVSxTQUFVVCxHQUNsQ0osUUFBUUMsSUFBSSwwQ0FDaEIsR0FFUixDQUVBLEdBQWtCSyxHQUNJLGVBQWRSLEtBQUtELE1BQ0xHLFFBQVFDLElBQUksaURBQWtESyxHQUd0QyxtQkFBakJSLEtBQUtILFNBQ1pLLFFBQVFjLE1BQU1oQixLQUFLRixZQUFZbUIsS0FBTywyQkFFMUNqQixLQUFLSCxRQUFRVyxFQUNqQixFQy9ESixNQUFNVSxFQUlGLEdBQVUsS0FLVm5CLEtBQU8sYUFLUEgsVUFBWSxLQUtaQyxRQUFVLEtBRVYsSUFBQUksR0FDeUIsT0FBakJELE1BQUssSUFJUyxlQUFkQSxLQUFLRCxNQUNMRyxRQUFRQyxJQUFJLDBCQUdoQkgsTUFBSyxFQUFVLElBQUlMLEVBQXVCSyxLQUFLSixVQUFXSSxLQUFLRCxNQUMvREMsTUFBSyxFQUFRSCxRQUFXVyxJQUNRLG1CQUFqQlIsS0FBS0gsU0FDWkssUUFBUWMsTUFBTWhCLEtBQUtGLFlBQVltQixLQUFPLDJCQUUxQ2pCLEtBQUtILFFBQVFXLEVBQVUsRUFFL0IsRUFPSixNQUFNVyxFQUFRLEdBS2QsSUFBSUMsRUFBUyxLQUViQyxLQUFLQyxVQUFhaEIsSUFDZCxNQUFNaUIsRUFBT2pCLEVBQU1hLE1BQU0sR0FFekJBLEVBQU1LLEtBQUtELEdBSUksT0FBWEgsSUFDQUEsRUFBUyxJQUFJRixFQUNiRSxFQUFPdkIsUUFBV1MsSUFDTSxlQUFoQmMsRUFBT3JCLE1BQ1BHLFFBQVFDLElBQUksNEJBQTZCRyxHQUc3QyxJQUFLLE1BQU1tQixLQUFVTixFQUNqQk0sRUFBT0MsWUFBWXBCLEVBQ3ZCLEdBSVJpQixFQUFLaEIsVUFBYW9CLElBQ2QsTUFBTUMsRUFBVUQsRUFBRWhCLFVBRUtDLElBQW5CZ0IsRUFBUUMsU0FDUlQsRUFBT3hCLFVBQVlnQyxFQUFRQyxPQUFPQyxJQUNsQ1YsRUFBT3JCLEtBQU82QixFQUFRQyxPQUFPOUIsS0FFN0JxQixFQUFPbkIsUUFHUyxlQUFoQm1CLEVBQU9yQixNQUNQRyxRQUFRQyxJQUFJLHdCQUF5QnlCLEVBQ3pDLENBQ0osQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NvdG9udGkvLi9zcmMvc2VydmVyRXZlbnRzL1NlcnZlclNlbnRFdmVudHNDbGllbnQuanMiLCJ3ZWJwYWNrOi8vY290b250aS8uL3NyYy9zZXJ2ZXJFdmVudHMvZHJpdmVyL3NoYXJlZFdvcmtlclNTRS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogU2VydmVyIFNlbnQgRXZlbnRzIGNsaWVudFxyXG4gKiBAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50c1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFNlcnZlclNlbnRFdmVudHNDbGllbnQge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfG51bGx9XHJcbiAgICAgKi9cclxuICAgIGV2ZW50c1VybCA9IG51bGw7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7RXZlbnRTb3VyY2V8bnVsbH1cclxuICAgICAqL1xyXG4gICAgI2V2ZW50U291cmNlID0gbnVsbDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtmdW5jdGlvbnxudWxsfVxyXG4gICAgICovXHJcbiAgICBvbkV2ZW50ID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihldmVudHNVcmwsIG1vZGUgPSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5ldmVudHNVcmwgPSBldmVudHNVcmw7XHJcbiAgICAgICAgaWYgKG1vZGUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5tb2RlID0gbW9kZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICBpZiAodGhpcy4jZXZlbnRTb3VyY2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpbml0IFNlcnZlclNlbnRFdmVudHNDbGllbnQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuI2V2ZW50U291cmNlID0gbmV3IEV2ZW50U291cmNlKHRoaXMuZXZlbnRzVXJsKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuI2V2ZW50U291cmNlLm9ub3BlbiA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlcnZlclNlbnRFdmVudHNDbGllbnQgY29ubmVjdGlvbiBpcyBvcGVuJyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiNldmVudFNvdXJjZS5vbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZXZlbnREYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTtcclxuICAgICAgICAgICAgaWYgKGV2ZW50RGF0YS5kYXRhICE9PSB1bmRlZmluZWQgJiYgKHR5cGVvZiBldmVudERhdGEuZGF0YSA9PT0gJ3N0cmluZycpICYmIGV2ZW50RGF0YS5kYXRhICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgZXZlbnREYXRhLmRhdGEgPSBKU09OLnBhcnNlKGV2ZW50RGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBldmVudERhdGEuZXZlbnRJZCA9IGV2ZW50Lmxhc3RFdmVudElkO1xyXG4gICAgICAgICAgICB0aGlzLiNvbkV2ZW50VHJpZ2dlcmVkKGV2ZW50RGF0YSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuI2V2ZW50U291cmNlLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTZXJ2ZXJTZW50RXZlbnRzQ2xpZW50IGNvbm5lY3Rpb24gZXJyb3InKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAjb25FdmVudFRyaWdnZXJlZChldmVudERhdGEpIHtcclxuICAgICAgICBpZiAodGhpcy5tb2RlICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlcnZlclNlbnRFdmVudHNDbGllbnQ6IFNlcnZlciB0cmlnZ2VyZWQgZXZlbnQnLCBldmVudERhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9uRXZlbnQgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLmNvbnN0cnVjdG9yLm5hbWUgKyAnLm9uRXZlbnQgaXMgbm90IGRlZmluZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vbkV2ZW50KGV2ZW50RGF0YSk7XHJcbiAgICB9XHJcbn1cclxuIiwiLyoqXHJcbiAqIFNoYXJlZCB3b3JrZXIgZm9yIFNlcnZlciBTZW50IEV2ZW50c1xyXG4gKiBAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50c1xyXG4gKiBAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2hhcmVkV29ya2VyXHJcbiAqL1xyXG5pbXBvcnQge1NlcnZlclNlbnRFdmVudHNDbGllbnR9IGZyb20gXCIuLi9TZXJ2ZXJTZW50RXZlbnRzQ2xpZW50XCI7XHJcblxyXG5jbGFzcyBTZXJ2ZXJTZW50RXZlbnRzIHtcclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge1NlcnZlclNlbnRFdmVudHNDbGllbnR8bnVsbH1cclxuICAgICAqL1xyXG4gICAgI2NsaWVudCA9IG51bGw7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfG51bGx9XHJcbiAgICAgKi9cclxuICAgIG1vZGUgPSAncHJvZHVjdGlvbic7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfG51bGx9XHJcbiAgICAgKi9cclxuICAgIGV2ZW50c1VybCA9IG51bGw7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7ZnVuY3Rpb258bnVsbH1cclxuICAgICAqL1xyXG4gICAgb25FdmVudCA9IG51bGw7XHJcblxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICBpZiAodGhpcy4jY2xpZW50ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaW5pdCBTaGFyZWQgd29ya2VyIFNTRScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4jY2xpZW50ID0gbmV3IFNlcnZlclNlbnRFdmVudHNDbGllbnQodGhpcy5ldmVudHNVcmwsIHRoaXMubW9kZSk7XHJcbiAgICAgICAgdGhpcy4jY2xpZW50Lm9uRXZlbnQgPSAoZXZlbnREYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5vbkV2ZW50ICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMuY29uc3RydWN0b3IubmFtZSArICcub25FdmVudCBpcyBub3QgZGVmaW5lZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMub25FdmVudChldmVudERhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBAdHlwZSB7TWVzc2FnZVBvcnRbXX1cclxuICovXHJcbmNvbnN0IHBvcnRzID0gW107XHJcblxyXG4vKipcclxuICogQHR5cGUge1NlcnZlclNlbnRFdmVudHN8bnVsbH1cclxuICovXHJcbmxldCBldmVudHMgPSBudWxsO1xyXG5cclxuc2VsZi5vbmNvbm5lY3QgPSAoZXZlbnQpID0+IHtcclxuICAgIGNvbnN0IHBvcnQgPSBldmVudC5wb3J0c1swXTtcclxuXHJcbiAgICBwb3J0cy5wdXNoKHBvcnQpO1xyXG5cclxuICAgIC8vIGNvbnNvbGUubG9nKCdTaGFyZWQgd29ya2VyIGNvbm5lY3RlZCcpO1xyXG5cclxuICAgIGlmIChldmVudHMgPT09IG51bGwpIHtcclxuICAgICAgICBldmVudHMgPSBuZXcgU2VydmVyU2VudEV2ZW50cygpO1xyXG4gICAgICAgIGV2ZW50cy5vbkV2ZW50ID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldmVudHMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2hhcmVkIHdvcmtlciBwb3N0TWVzc2FnZScsIGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCBjbGllbnQgb2YgcG9ydHMpIHtcclxuICAgICAgICAgICAgICAgIGNsaWVudC5wb3N0TWVzc2FnZShldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcG9ydC5vbm1lc3NhZ2UgPSAoZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlLmRhdGE7XHJcblxyXG4gICAgICAgIGlmIChtZXNzYWdlLmNvbmZpZyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGV2ZW50cy5ldmVudHNVcmwgPSBtZXNzYWdlLmNvbmZpZy51cmw7XHJcbiAgICAgICAgICAgIGV2ZW50cy5tb2RlID0gbWVzc2FnZS5jb25maWcubW9kZTtcclxuXHJcbiAgICAgICAgICAgIGV2ZW50cy5pbml0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZXZlbnRzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU2hhcmVkIHdvcmtlciBtZXNzYWdlJywgbWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJTZXJ2ZXJTZW50RXZlbnRzQ2xpZW50IiwiZXZlbnRzVXJsIiwib25FdmVudCIsImNvbnN0cnVjdG9yIiwibW9kZSIsInRoaXMiLCJpbml0IiwiY29uc29sZSIsImxvZyIsIkV2ZW50U291cmNlIiwib25vcGVuIiwiZXZlbnQiLCJvbm1lc3NhZ2UiLCJldmVudERhdGEiLCJKU09OIiwicGFyc2UiLCJkYXRhIiwidW5kZWZpbmVkIiwiZXZlbnRJZCIsImxhc3RFdmVudElkIiwib25lcnJvciIsImVycm9yIiwibmFtZSIsIlNlcnZlclNlbnRFdmVudHMiLCJwb3J0cyIsImV2ZW50cyIsInNlbGYiLCJvbmNvbm5lY3QiLCJwb3J0IiwicHVzaCIsImNsaWVudCIsInBvc3RNZXNzYWdlIiwiZSIsIm1lc3NhZ2UiLCJjb25maWciLCJ1cmwiXSwic291cmNlUm9vdCI6IiJ9