(()=>{"use strict";class e{eventsUrl=null;#e=null;onEvent=null;constructor(e,n=null){this.eventsUrl=e,null!==n&&(this.mode=n),this.init()}init(){null===this.#e&&("production"!==this.mode&&console.log("init ServerSentEventsClient"),this.#e=new EventSource(this.eventsUrl),"production"!==this.mode&&(this.#e.onopen=function(e){console.log("ServerSentEventsClient connection is open")}),this.#e.onmessage=e=>{const n=JSON.parse(e.data);void 0!==n.data&&"string"==typeof n.data&&""!==n.data&&(n.data=JSON.parse(n.data)),n.id=e.lastEventId,this.#n(n)},"production"!==this.mode&&(this.#e.onerror=function(e){console.log("ServerSentEventsClient connection error")}))}#n(e){"production"!==this.mode&&console.log("ServerSentEventsClient: Server triggered event",e),"function"!=typeof this.onEvent&&console.error(this.constructor.name+".onEvent is not defined"),this.onEvent(e)}}class n{#t=null;mode="production";eventsUrl=null;onEvent=null;init(){null===this.#t&&("production"!==this.mode&&console.log("init Shared worker SSE"),this.#t=new e(this.eventsUrl,this.mode),this.#t.onEvent=e=>{"function"!=typeof this.onEvent&&console.error(this.constructor.name+".onEvent is not defined"),this.onEvent(e)})}}const t=[];let o=null;self.onconnect=e=>{const s=e.ports[0];t.push(s),null===o&&(o=new n,o.onEvent=e=>{"production"!==o.mode&&console.log("Shared worker postMessage",e);for(const n of t)n.postMessage(e)}),s.onmessage=e=>{const n=e.data;void 0!==n.config&&(o.eventsUrl=n.config.url,o.mode=n.config.mode,o.init()),"production"!==o.mode&&console.log("Shared worker message",n)}}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBSU8sTUFBTUEsRUFJVEMsVUFBWSxLQUtaLEdBQWUsS0FLZkMsUUFBVSxLQUVWLFdBQUFDLENBQVlGLEVBQVdHLEVBQU8sTUFDMUJDLEtBQUtKLFVBQVlBLEVBQ0osT0FBVEcsSUFDQUMsS0FBS0QsS0FBT0EsR0FFaEJDLEtBQUtDLE1BQ1QsQ0FFQSxJQUFBQSxHQUM4QixPQUF0QkQsTUFBSyxJQUlTLGVBQWRBLEtBQUtELE1BQ0xHLFFBQVFDLElBQUksK0JBR2hCSCxNQUFLLEVBQWUsSUFBSUksWUFBWUosS0FBS0osV0FFdkIsZUFBZEksS0FBS0QsT0FDTEMsTUFBSyxFQUFhSyxPQUFTLFNBQVVDLEdBQ2pDSixRQUFRQyxJQUFJLDRDQUNoQixHQUdKSCxNQUFLLEVBQWFPLFVBQWFELElBQzNCLE1BQU1FLEVBQVlDLEtBQUtDLE1BQU1KLEVBQU1LLFdBQ1pDLElBQW5CSixFQUFVRyxNQUFpRCxpQkFBbkJILEVBQVVHLE1BQXlDLEtBQW5CSCxFQUFVRyxPQUNsRkgsRUFBVUcsS0FBT0YsS0FBS0MsTUFBTUYsRUFBVUcsT0FFMUNILEVBQVVLLEdBQUtQLEVBQU1RLFlBQ3JCZCxNQUFLLEVBQWtCUSxFQUFVLEVBR25CLGVBQWRSLEtBQUtELE9BQ0xDLE1BQUssRUFBYWUsUUFBVSxTQUFVVCxHQUNsQ0osUUFBUUMsSUFBSSwwQ0FDaEIsR0FFUixDQUVBLEdBQWtCSyxHQUNJLGVBQWRSLEtBQUtELE1BQ0xHLFFBQVFDLElBQUksaURBQWtESyxHQUd0QyxtQkFBakJSLEtBQUtILFNBQ1pLLFFBQVFjLE1BQU1oQixLQUFLRixZQUFZbUIsS0FBTywyQkFFMUNqQixLQUFLSCxRQUFRVyxFQUNqQixFQy9ESixNQUFNVSxFQUlGLEdBQVUsS0FLVm5CLEtBQU8sYUFLUEgsVUFBWSxLQUtaQyxRQUFVLEtBRVYsSUFBQUksR0FDeUIsT0FBakJELE1BQUssSUFJUyxlQUFkQSxLQUFLRCxNQUNMRyxRQUFRQyxJQUFJLDBCQUdoQkgsTUFBSyxFQUFVLElBQUlMLEVBQXVCSyxLQUFLSixVQUFXSSxLQUFLRCxNQUMvREMsTUFBSyxFQUFRSCxRQUFXVyxJQUNRLG1CQUFqQlIsS0FBS0gsU0FDWkssUUFBUWMsTUFBTWhCLEtBQUtGLFlBQVltQixLQUFPLDJCQUUxQ2pCLEtBQUtILFFBQVFXLEVBQVUsRUFFL0IsRUFPSixNQUFNVyxFQUFRLEdBS2QsSUFBSUMsRUFBUyxLQUViQyxLQUFLQyxVQUFhaEIsSUFDZCxNQUFNaUIsRUFBT2pCLEVBQU1hLE1BQU0sR0FFekJBLEVBQU1LLEtBQUtELEdBSUksT0FBWEgsSUFDQUEsRUFBUyxJQUFJRixFQUNiRSxFQUFPdkIsUUFBV1MsSUFDTSxlQUFoQmMsRUFBT3JCLE1BQ1BHLFFBQVFDLElBQUksNEJBQTZCRyxHQUc3QyxJQUFLLE1BQU1tQixLQUFVTixFQUNqQk0sRUFBT0MsWUFBWXBCLEVBQ3ZCLEdBSVJpQixFQUFLaEIsVUFBYW9CLElBQ2QsTUFBTUMsRUFBVUQsRUFBRWhCLFVBRUtDLElBQW5CZ0IsRUFBUUMsU0FDUlQsRUFBT3hCLFVBQVlnQyxFQUFRQyxPQUFPQyxJQUNsQ1YsRUFBT3JCLEtBQU82QixFQUFRQyxPQUFPOUIsS0FFN0JxQixFQUFPbkIsUUFHUyxlQUFoQm1CLEVBQU9yQixNQUNQRyxRQUFRQyxJQUFJLHdCQUF5QnlCLEVBQ3pDLENBQ0osQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NvdG9udGkvLi9zcmMvc2VydmVyRXZlbnRzL1NlcnZlclNlbnRFdmVudHNDbGllbnQuanMiLCJ3ZWJwYWNrOi8vY290b250aS8uL3NyYy9zZXJ2ZXJFdmVudHMvZHJpdmVyL3NoYXJlZFdvcmtlclNTRS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogU2VydmVyIFNlbnQgRXZlbnRzIGNsaWVudFxyXG4gKiBAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmVyLXNlbnRfZXZlbnRzL1VzaW5nX3NlcnZlci1zZW50X2V2ZW50c1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFNlcnZlclNlbnRFdmVudHNDbGllbnQge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfG51bGx9XHJcbiAgICAgKi9cclxuICAgIGV2ZW50c1VybCA9IG51bGw7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7RXZlbnRTb3VyY2V8bnVsbH1cclxuICAgICAqL1xyXG4gICAgI2V2ZW50U291cmNlID0gbnVsbDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtmdW5jdGlvbnxudWxsfVxyXG4gICAgICovXHJcbiAgICBvbkV2ZW50ID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihldmVudHNVcmwsIG1vZGUgPSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5ldmVudHNVcmwgPSBldmVudHNVcmw7XHJcbiAgICAgICAgaWYgKG1vZGUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5tb2RlID0gbW9kZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICBpZiAodGhpcy4jZXZlbnRTb3VyY2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpbml0IFNlcnZlclNlbnRFdmVudHNDbGllbnQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuI2V2ZW50U291cmNlID0gbmV3IEV2ZW50U291cmNlKHRoaXMuZXZlbnRzVXJsKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuI2V2ZW50U291cmNlLm9ub3BlbiA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NlcnZlclNlbnRFdmVudHNDbGllbnQgY29ubmVjdGlvbiBpcyBvcGVuJyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiNldmVudFNvdXJjZS5vbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZXZlbnREYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTtcclxuICAgICAgICAgICAgaWYgKGV2ZW50RGF0YS5kYXRhICE9PSB1bmRlZmluZWQgJiYgKHR5cGVvZiBldmVudERhdGEuZGF0YSA9PT0gJ3N0cmluZycpICYmIGV2ZW50RGF0YS5kYXRhICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgZXZlbnREYXRhLmRhdGEgPSBKU09OLnBhcnNlKGV2ZW50RGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBldmVudERhdGEuaWQgPSBldmVudC5sYXN0RXZlbnRJZDtcclxuICAgICAgICAgICAgdGhpcy4jb25FdmVudFRyaWdnZXJlZChldmVudERhdGEpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICB0aGlzLiNldmVudFNvdXJjZS5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmVyU2VudEV2ZW50c0NsaWVudCBjb25uZWN0aW9uIGVycm9yJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgI29uRXZlbnRUcmlnZ2VyZWQoZXZlbnREYXRhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTZXJ2ZXJTZW50RXZlbnRzQ2xpZW50OiBTZXJ2ZXIgdHJpZ2dlcmVkIGV2ZW50JywgZXZlbnREYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5vbkV2ZW50ICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5jb25zdHJ1Y3Rvci5uYW1lICsgJy5vbkV2ZW50IGlzIG5vdCBkZWZpbmVkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub25FdmVudChldmVudERhdGEpO1xyXG4gICAgfVxyXG59XHJcbiIsIi8qKlxyXG4gKiBTaGFyZWQgd29ya2VyIGZvciBTZXJ2ZXIgU2VudCBFdmVudHNcclxuICogQGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1NlcnZlci1zZW50X2V2ZW50cy9Vc2luZ19zZXJ2ZXItc2VudF9ldmVudHNcclxuICogQGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1NoYXJlZFdvcmtlclxyXG4gKi9cclxuaW1wb3J0IHtTZXJ2ZXJTZW50RXZlbnRzQ2xpZW50fSBmcm9tIFwiLi4vU2VydmVyU2VudEV2ZW50c0NsaWVudFwiO1xyXG5cclxuY2xhc3MgU2VydmVyU2VudEV2ZW50cyB7XHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtTZXJ2ZXJTZW50RXZlbnRzQ2xpZW50fG51bGx9XHJcbiAgICAgKi9cclxuICAgICNjbGllbnQgPSBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ3xudWxsfVxyXG4gICAgICovXHJcbiAgICBtb2RlID0gJ3Byb2R1Y3Rpb24nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ3xudWxsfVxyXG4gICAgICovXHJcbiAgICBldmVudHNVcmwgPSBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge2Z1bmN0aW9ufG51bGx9XHJcbiAgICAgKi9cclxuICAgIG9uRXZlbnQgPSBudWxsO1xyXG5cclxuICAgIGluaXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuI2NsaWVudCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5tb2RlICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2luaXQgU2hhcmVkIHdvcmtlciBTU0UnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuI2NsaWVudCA9IG5ldyBTZXJ2ZXJTZW50RXZlbnRzQ2xpZW50KHRoaXMuZXZlbnRzVXJsLCB0aGlzLm1vZGUpO1xyXG4gICAgICAgIHRoaXMuI2NsaWVudC5vbkV2ZW50ID0gKGV2ZW50RGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMub25FdmVudCAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLmNvbnN0cnVjdG9yLm5hbWUgKyAnLm9uRXZlbnQgaXMgbm90IGRlZmluZWQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm9uRXZlbnQoZXZlbnREYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogQHR5cGUge01lc3NhZ2VQb3J0W119XHJcbiAqL1xyXG5jb25zdCBwb3J0cyA9IFtdO1xyXG5cclxuLyoqXHJcbiAqIEB0eXBlIHtTZXJ2ZXJTZW50RXZlbnRzfG51bGx9XHJcbiAqL1xyXG5sZXQgZXZlbnRzID0gbnVsbDtcclxuXHJcbnNlbGYub25jb25uZWN0ID0gKGV2ZW50KSA9PiB7XHJcbiAgICBjb25zdCBwb3J0ID0gZXZlbnQucG9ydHNbMF07XHJcblxyXG4gICAgcG9ydHMucHVzaChwb3J0KTtcclxuXHJcbiAgICAvLyBjb25zb2xlLmxvZygnU2hhcmVkIHdvcmtlciBjb25uZWN0ZWQnKTtcclxuXHJcbiAgICBpZiAoZXZlbnRzID09PSBudWxsKSB7XHJcbiAgICAgICAgZXZlbnRzID0gbmV3IFNlcnZlclNlbnRFdmVudHMoKTtcclxuICAgICAgICBldmVudHMub25FdmVudCA9IChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLm1vZGUgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NoYXJlZCB3b3JrZXIgcG9zdE1lc3NhZ2UnLCBldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2xpZW50IG9mIHBvcnRzKSB7XHJcbiAgICAgICAgICAgICAgICBjbGllbnQucG9zdE1lc3NhZ2UoZXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHBvcnQub25tZXNzYWdlID0gKGUpID0+IHtcclxuICAgICAgICBjb25zdCBtZXNzYWdlID0gZS5kYXRhO1xyXG5cclxuICAgICAgICBpZiAobWVzc2FnZS5jb25maWcgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBldmVudHMuZXZlbnRzVXJsID0gbWVzc2FnZS5jb25maWcudXJsO1xyXG4gICAgICAgICAgICBldmVudHMubW9kZSA9IG1lc3NhZ2UuY29uZmlnLm1vZGU7XHJcblxyXG4gICAgICAgICAgICBldmVudHMuaW5pdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGV2ZW50cy5tb2RlICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NoYXJlZCB3b3JrZXIgbWVzc2FnZScsIG1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsiU2VydmVyU2VudEV2ZW50c0NsaWVudCIsImV2ZW50c1VybCIsIm9uRXZlbnQiLCJjb25zdHJ1Y3RvciIsIm1vZGUiLCJ0aGlzIiwiaW5pdCIsImNvbnNvbGUiLCJsb2ciLCJFdmVudFNvdXJjZSIsIm9ub3BlbiIsImV2ZW50Iiwib25tZXNzYWdlIiwiZXZlbnREYXRhIiwiSlNPTiIsInBhcnNlIiwiZGF0YSIsInVuZGVmaW5lZCIsImlkIiwibGFzdEV2ZW50SWQiLCJvbmVycm9yIiwiZXJyb3IiLCJuYW1lIiwiU2VydmVyU2VudEV2ZW50cyIsInBvcnRzIiwiZXZlbnRzIiwic2VsZiIsIm9uY29ubmVjdCIsInBvcnQiLCJwdXNoIiwiY2xpZW50IiwicG9zdE1lc3NhZ2UiLCJlIiwibWVzc2FnZSIsImNvbmZpZyIsInVybCJdLCJzb3VyY2VSb290IjoiIn0=